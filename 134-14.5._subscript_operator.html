<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>14.5. Subscript Operator</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="page_styles.css" type="text/css" rel="stylesheet"/>
</head>
  <body class="calibre">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="133-14.4._assignment_operators.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="135-14.6._increment_and_decrement_operators.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table><h3 id="filepos3620887" class="calibre29"><span class="bold">14.5. Subscript Operator</span></h3><div class="calibre12">&#160;</div>
<p class="calibre14">Classes that represent containers from which elements can be retrieved by position often define the subscript operator, <code class="calibre23"><tt class="calibre23"><span class="calibre24">operator[]</span></tt></code>.</p><div class="calibre15">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><a id="filepos3621264"/><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 14.4</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 14.20:</strong> Define the addition and compound-assignment operators for your <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_data</span></tt></code> class.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 14.21:</strong> Write the <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_data</span></tt></code> operators so that <code class="calibre23"><tt class="calibre23"><span class="calibre24">+</span></tt></code> does the actual addition and <code class="calibre23"><tt class="calibre23"><span class="calibre24">+=</span></tt></code> calls <code class="calibre23"><tt class="calibre23"><span class="calibre24">+</span></tt></code>. Discuss the disadvantages of this approach compared to the way these operators were defined in &#167; <a href="132-14.3._arithmetic_and_relational_operators.html#filepos3595833">14.3</a> (p. <a href="132-14.3._arithmetic_and_relational_operators.html#filepos3595833">560</a>) and &#167; <a href="133-14.4._assignment_operators.html#filepos3614210">14.4</a> (p. <a href="133-14.4._assignment_operators.html#filepos3614210">564</a>).</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 14.22:</strong> Define a version of the assignment operator that can assign a <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> representing an <small class="calibre48">ISBN</small> to a <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_data</span></tt></code>.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 14.23:</strong> Define an <code class="calibre23"><tt class="calibre23"><span class="calibre24">initializer_list</span></tt></code> assignment operator for your version of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">StrVec</span></tt></code> class.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 14.24:</strong> Decide whether the class you used in <a href="077-7.5._constructors_revisited.html#filepos1972067">exercise 7.40</a> from &#167; <a href="077-7.5._constructors_revisited.html#filepos1953073">7.5.1</a> (p. <a href="077-7.5._constructors_revisited.html#filepos1953073">291</a>) needs a copy- and move-assignment operator. If so, define those operators.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 14.25:</strong> Implement any other assignment operators your class should define. Explain which types should be used as operands and why.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00012.jpg" class="calibre9"/> Note</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">The subscript operator must be a member function.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<p class="calibre14">To be compatible with the ordinary meaning of subscript, the subscript operator usually returns a reference to the element that is fetched. By returning a reference, subscript can be used on either side of an assignment. Consequently, it is also usually a good idea to define both <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> and non<code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> versions of this operator. When applied to a <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> object, subscript should return a reference to <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> so that it is not possible to assign to the returned object.</p><div class="calibre15">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00017.jpg" class="calibre9"/> Best Practices</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">If a class has a subscript operator, it usually should define two versions: one that returns a plain reference and the other that is a <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> member and returns a reference to <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code>.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<p class="calibre14">As an example, we&#8217;ll define subscript for <code class="calibre23"><tt class="calibre23"><span class="calibre24">StrVec</span></tt></code> (&#167; <a href="125-13.5._classes_that_manage_dynamic_memory.html#filepos3380687">13.5</a>, p. <a href="125-13.5._classes_that_manage_dynamic_memory.html#filepos3380687">526</a>):</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">class StrVec {<br class="calibre6"/>public:<br class="calibre6"/>&#160;&#160;&#160;&#160;std::string&amp; operator[](std::size_t n)<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{ return elements[n]; }<br class="calibre6"/>&#160;&#160;&#160;&#160;const std::string&amp; operator[](std::size_t n) const<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{ return elements[n]; }<br class="calibre6"/>&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">other members as in &#167; 13.5 (p. 526)</span></span></span><br class="calibre6"/>private:<br class="calibre6"/>&#160;&#160;&#160;&#160;std::string *elements;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">pointer to the first element in the array</span></span></span><br class="calibre6"/>};</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre25">We can use these operators similarly to how we subscript a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> or array. Because subscript returns a reference to an element, if the <code class="calibre23"><tt class="calibre23"><span class="calibre24">StrVec</span></tt></code> is non<code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code>, we can assign to that element; if we subscript a <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> object, we can&#8217;t:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"><a id="filepos3627373"/></span></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">assume</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">svec</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">is a</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">StrVec</span></span></tt></span><br class="calibre6"/>const StrVec cvec = svec; // <span><span class="calibre45"><span class="calibre16">copy elements from</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">svec</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">into</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cvec</span></span></tt></span><br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">if</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">svec</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">has any elements, run the</span></span></span>&#160;&#160;<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">string empty</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">function on the first one</span></span></span><br class="calibre6"/>if (svec.size() &amp;&amp; svec[0].empty())&#160;&#160;{<br class="calibre6"/>&#160;&#160;&#160;&#160;svec[0] = "zero"; // <span><span class="calibre45"><span class="calibre16">ok: subscript returns a reference to a</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">string</span></span></tt></span><br class="calibre6"/>&#160;&#160;&#160;&#160;cvec[0] = "Zip";&#160;&#160;// <span><span class="calibre45"><span class="calibre16">error: subscripting</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cvec</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">returns a reference to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">const</span></span></tt></span><br class="calibre6"/>}</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 14.5</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 14.26:</strong> Define subscript operators for your <code class="calibre23"><tt class="calibre23"><span class="calibre24">StrVec</span></tt></code>, <code class="calibre23"><tt class="calibre23"><span class="calibre24">String</span></tt></code>, <code class="calibre23"><tt class="calibre23"><span class="calibre24">StrBlob</span></tt></code>, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">StrBlobPtr</span></tt></code> classes.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="133-14.4._assignment_operators.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="135-14.6._increment_and_decrement_operators.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table></body></html>
