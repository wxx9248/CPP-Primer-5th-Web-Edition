<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>11.2. Overview of the Associative Containers</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="page_styles.css" type="text/css" rel="stylesheet"/>
</head>
  <body class="calibre">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="107-11.1._using_an_associative_container.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="109-11.3._operations_on_associative_containers.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table><h3 id="filepos2739630" class="calibre29"><span class="bold"><a id="filepos2739663" class="calibre2"/>11.2. Overview of the Associative Containers</span></h3><div class="calibre12">&#160;</div>
<p class="calibre14">Associative containers (both ordered and unordered) support the general container operations covered in &#167; <a href="090-9.2._container_library_overview.html#filepos2188055">9.2</a> (p. <a href="090-9.2._container_library_overview.html#filepos2188055">328</a>) and listed in <a href="090-9.2._container_library_overview.html#filepos2188610">Table 9.2</a> (p. <a href="090-9.2._container_library_overview.html#filepos2188610">330</a>). The associative containers do <em class="calibre16">not</em> support the sequential-container position-specific operations, such as <code class="calibre23"><tt class="calibre23"><span class="calibre24">push_front</span></tt></code> or <code class="calibre23"><tt class="calibre23"><span class="calibre24">back</span></tt></code>. Because the elements are stored based on their keys, these operations would be meaningless for the associative containers. Moreover, the associative containers do not support the constructors or insert operations that take an element value and a count.</p><div class="calibre15">&#160;</div>
<p class="calibre25">In addition to the operations they share with the sequential containers, the associative containers provide some operations (<a href="109-11.3._operations_on_associative_containers.html#filepos2831111">Table 11.7</a> (p. <a href="109-11.3._operations_on_associative_containers.html#filepos2831111">438</a>)) and type aliases (<a href="109-11.3._operations_on_associative_containers.html#filepos2777022">Table 11.3</a> (p. <a href="109-11.3._operations_on_associative_containers.html#filepos2777022">429</a>)) that the sequential containers do not. In addition, the unordered containers provide operations for tuning their hash performance, which we&#8217;ll cover in &#167; <a href="110-11.4._the_unordered_containers.html#filepos2872751">11.4</a> (p. <a href="110-11.4._the_unordered_containers.html#filepos2872751">444</a>).</p><div class="calibre22">&#160;</div>
<p class="calibre25">The associative container iterators are bidirectional (&#167; <a href="102-10.5._structure_of_generic_algorithms.html#filepos2673303">10.5.1</a>, p. <a href="102-10.5._structure_of_generic_algorithms.html#filepos2673303">410</a>).</p><div class="calibre22">&#160;</div>
<h4 id="filepos2741390" class="calibre37"><span class="calibre5">11.2.1. Defining an Associative Container</span></h4><div class="calibre38">&#160;</div>
<div class="calibre28"><img alt="Image" src="images/00009.jpg" class="calibre9"/></div>
<p class="calibre14">As we&#8217;ve just seen, when we define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code>, we must indicate both the key and value type; when we define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code>, we specify only a key type, because there is no value type. Each of the associative containers defines a default constructor, which creates an empty container of the specified type. We can also initialize an associative container as a copy of another container of the same type or from a range of values, so long as those values can be converted to the type of the container. Under the new standard, we can also list initialize the elements:</p><div class="calibre15">&#160;</div>
<div class="calibre28"><a id="filepos2742321"/><img alt="Image" src="images/00008.jpg" class="calibre9"/></div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">map&lt;string, size_t&gt; word_count;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">empty</span></span></span><br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">list initialization</span></span></span><br class="calibre6"/>set&lt;string&gt; exclude = {"the", "but", "and", "or", "an", "a",<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;"The", "But", "And", "Or", "An", "A"};<br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">three elements;</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">authors</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">maps last name to first</span></span></span><br class="calibre6"/>map&lt;string, string&gt; authors = { {"Joyce", "James"},<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{"Austen", "Jane"},<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{"Dickens", "Charles"} };</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">As usual, the initializers must be convertible to the type in the container. For <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code>, the element type is the key type.</p><div class="calibre15">&#160;</div>
<p class="calibre25">When we initialize a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code>, we have to supply both the key and the value. We wrap each key&#8211;value pair inside curly braces:</p><div class="calibre22">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">{<span><span class="calibre45"><span class="calibre16">key</span></span></span>, <span><span class="calibre45"><span class="calibre16">value</span></span></span>}</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">to indicate that the items together form one element in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code>. The key is the first element in each pair, and the value is the second. Thus, <code class="calibre23"><tt class="calibre23"><span class="calibre24">authors</span></tt></code> maps last names to first names, and is initialized with three elements.</p><div class="calibre15">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Initializing a <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">multimap</span></span></tt></span></span></tt></code> or <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">multiset</span></span></tt></span></span></tt></code></span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">The keys in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> or a <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code> must be unique; there can be only one element with a given key. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">multimap</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">multiset</span></tt></code> containers have no such restriction; <a id="filepos2745857"/>there can be several elements with the same key. For example, the <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> we used to count words must have only one element per given word. On the other hand, a dictionary could have several definitions associated with a particular word.</p><div class="calibre15">&#160;</div>
<p class="calibre25">The following example illustrates the differences between the containers with unique keys and those that have multiple keys. First, we&#8217;ll create a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> of <code class="calibre23"><tt class="calibre23"><span class="calibre24">int</span></tt></code>s named <code class="calibre23"><tt class="calibre23"><span class="calibre24">ivec</span></tt></code> that has 20 elements: two copies of each of the integers from 0 through 9 inclusive. We&#8217;ll use that <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> to initialize a <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code> and a <code class="calibre23"><tt class="calibre23"><span class="calibre24">multiset</span></tt></code>:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">define a</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">vector</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">with 20 elements, holding two copies of each number from 0 to 9</span></span></span><br class="calibre6"/>vector&lt;int&gt; ivec;<br class="calibre6"/>for (vector&lt;int&gt;::size_type i = 0; i != 10; ++i) {<br class="calibre6"/>&#160;&#160;&#160;&#160;ivec.push_back(i);<br class="calibre6"/>&#160;&#160;&#160;&#160;ivec.push_back(i);&#160;&#160;// <span><span class="calibre45"><span class="calibre16">duplicate copies of each number</span></span></span><br class="calibre6"/>}<br class="calibre6"/>// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">iset</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">holds unique elements from</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">ivec</span></span></tt></span><span><span class="calibre45"><span class="calibre16">;</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">miset</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">holds all 20 elements</span></span></span><br class="calibre6"/>set&lt;int&gt; iset(ivec.cbegin(), ivec.cend());<br class="calibre6"/>multiset&lt;int&gt; miset(ivec.cbegin(), ivec.cend());<br class="calibre6"/>cout &lt;&lt; ivec.size() &lt;&lt; endl;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">prints</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">20</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; iset.size() &lt;&lt; endl;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">prints</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">10</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; miset.size() &lt;&lt; endl;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">prints</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">20</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Even though we initialized <code class="calibre23"><tt class="calibre23"><span class="calibre24">iset</span></tt></code> from the entire <code class="calibre23"><tt class="calibre23"><span class="calibre24">ivec</span></tt></code> container, <code class="calibre23"><tt class="calibre23"><span class="calibre24">iset</span></tt></code> has only ten elements: one for each distinct element in <code class="calibre23"><tt class="calibre23"><span class="calibre24">ivec</span></tt></code>. On the other hand, <code class="calibre23"><tt class="calibre23"><span class="calibre24">miset</span></tt></code> has 20 elements, the same as the number of elements in <code class="calibre23"><tt class="calibre23"><span class="calibre24">ivec</span></tt></code>.</p><div class="calibre15">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 11.2.1</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.5:</strong> Explain the difference between a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> and a <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code>. When might you use one or the other?</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.6:</strong> Explain the difference between a <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code> and a <code class="calibre23"><tt class="calibre23"><span class="calibre24">list</span></tt></code>. When might you use one or the other?</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.7:</strong> Define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> for which the key is the family&#8217;s last name and the value is a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> of the children&#8217;s names. Write code to add new families and to add new children to an existing family.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.8:</strong> Write a program that stores the excluded words in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> instead of in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code>. What are the advantages to using a <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code>?</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h4 id="filepos2751456" class="calibre37"><span class="calibre5">11.2.2. Requirements on Key Type</span></h4><div class="calibre38">&#160;</div>
<div class="calibre28"><img alt="Image" src="images/00009.jpg" class="calibre9"/></div>
<p class="calibre14">The associative containers place constraints on the type that is used as a key. We&#8217;ll cover the requirements for keys in the unordered containers in &#167; <a href="110-11.4._the_unordered_containers.html#filepos2872751">11.4</a> (p. <a href="110-11.4._the_unordered_containers.html#filepos2872751">445</a>). For the ordered containers&#8212;<code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code>, <code class="calibre23"><tt class="calibre23"><span class="calibre24">multimap</span></tt></code>, <code class="calibre23"><tt class="calibre23"><span class="calibre24">set</span></tt></code>, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">multiset</span></tt></code>&#8212;the key type must define a way to compare the elements. By default, the library uses the <code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;</span></tt></code> operator for the key type to compare the keys. In the set types, the key is the element type; <a id="filepos2752458"/>in the map types, the key is the first type. Thus, the key type for <code class="calibre23"><tt class="calibre23"><span class="calibre24">word_count</span></tt></code> in &#167; <a href="107-11.1._using_an_associative_container.html#filepos2724280">11.1</a> (p. <a href="107-11.1._using_an_associative_container.html#filepos2724280">421</a>) is <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>. Similarly, the key type for <code class="calibre23"><tt class="calibre23"><span class="calibre24">exclude</span></tt></code> is <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>.</p><div class="calibre15">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00012.jpg" class="calibre9"/> Note</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">Callable objects passed to a sort algorithm (&#167; <a href="100-10.3._customizing_operations.html#filepos2520495">10.3.1</a>, p. <a href="100-10.3._customizing_operations.html#filepos2520495">386</a>) must meet the same requirements as do the keys in an associative container.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Key Types for Ordered Containers</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">Just as we can provide our own comparison operation to an algorithm (&#167; <a href="100-10.3._customizing_operations.html#filepos2519145">10.3</a>, p. <a href="100-10.3._customizing_operations.html#filepos2519145">385</a>), we can also supply our own operation to use in place of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;</span></tt></code> operator on keys. The specified operation must define a <strong class="calibre5"><a id="filepos2753964" href="112-defined_terms.html#filepos2895653">strict weak ordering</a></strong> over the key type. We can think of a strict weak ordering as &#8220;less than,&#8221; although our function might use a more complicated procedure. However we define it, the comparison function must have the following properties:</p><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; Two keys cannot both be &#8220;less than&#8221; each other; if <code class="calibre23"><tt class="calibre23"><span class="calibre24">k1</span></tt></code> is &#8220;less than&#8221; <code class="calibre23"><tt class="calibre23"><span class="calibre24">k2</span></tt></code>, then <code class="calibre23"><tt class="calibre23"><span class="calibre24">k2</span></tt></code> must never be &#8220;less than&#8221; <code class="calibre23"><tt class="calibre23"><span class="calibre24">k1</span></tt></code>.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; If <code class="calibre23"><tt class="calibre23"><span class="calibre24">k1</span></tt></code> is &#8220;less than&#8221; <code class="calibre23"><tt class="calibre23"><span class="calibre24">k2</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">k2</span></tt></code> is &#8220;less than&#8221; <code class="calibre23"><tt class="calibre23"><span class="calibre24">k3</span></tt></code>, then <code class="calibre23"><tt class="calibre23"><span class="calibre24">k1</span></tt></code> must be &#8220;less than&#8221; <code class="calibre23"><tt class="calibre23"><span class="calibre24">k3</span></tt></code>.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; If there are two keys, and neither key is &#8220;less than&#8221; the other, then we&#8217;ll say that those keys are &#8220;equivalent.&#8221; If <code class="calibre23"><tt class="calibre23"><span class="calibre24">k1</span></tt></code> is &#8220;equivalent&#8221; to <code class="calibre23"><tt class="calibre23"><span class="calibre24">k2</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">k2</span></tt></code> is &#8220;equivalent&#8221; to <code class="calibre23"><tt class="calibre23"><span class="calibre24">k3</span></tt></code>, then <code class="calibre23"><tt class="calibre23"><span class="calibre24">k1</span></tt></code> must be &#8220;equivalent&#8221; to <code class="calibre23"><tt class="calibre23"><span class="calibre24">k3</span></tt></code>.</p></blockquote><div class="calibre15">&#160;</div>
<p class="calibre14">If two keys are equivalent (i.e., if neither is &#8220;less than&#8221; the other), the container treats them as equal. When used as a key to a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code>, there will be only one element associated with those keys, and either key can be used to access the corresponding value.</p><div class="calibre15">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00012.jpg" class="calibre9"/> Note</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">In practice, what&#8217;s important is that a type that defines a <code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;</span></tt></code> operator that &#8220;behaves normally&#8221; can be used as a key.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Using a Comparison Function for the Key Type</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">The type of the operation that a container uses to organize its elements is part of the type of that container. To specify our own operation, we must supply the type of that operation when we define the type of an associative container. The operation type is specified following the element type inside the angle brackets that we use to say which type of container we are defining.</p><div class="calibre15">&#160;</div>
<p class="calibre25">Each type inside the angle brackets is just that, a type. We supply a particular comparison operation (that must have the same type as we specified inside the angle brackets) as a constructor argument when we create a container.</p><div class="calibre22">&#160;</div>
<p class="calibre25">For example, we can&#8217;t directly define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">multiset</span></tt></code> of <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_data</span></tt></code> because <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_data</span></tt></code> doesn&#8217;t have a <code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;</span></tt></code> operator. However, we can use the <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code> function from the exercises in &#167; <a href="100-10.3._customizing_operations.html#filepos2520495">10.3.1</a> (p. <a href="100-10.3._customizing_operations.html#filepos2520495">387</a>) to define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">multiset</span></tt></code>. That function defines a strict weak ordering based on their <small class="calibre48">ISBN</small>s of two given <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_data</span></tt></code> objects. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code> function should look something like</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"><a id="filepos2758977"/></span></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bool compareIsbn(const Sales_data &amp;lhs, const Sales_data &amp;rhs)<br class="calibre6"/>{<br class="calibre6"/>&#160;&#160;&#160;&#160;return lhs.isbn() &lt; rhs.isbn();<br class="calibre6"/>}</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">To use our own operation, we must define the <code class="calibre23"><tt class="calibre23"><span class="calibre24">multiset</span></tt></code> with two types: the key type, <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_data</span></tt></code>, and the comparison type, which is a function pointer type (&#167; <a href="069-6.7._pointers_to_functions.html#filepos1702852">6.7</a>, p. <a href="069-6.7._pointers_to_functions.html#filepos1702852">247</a>) that can point to <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code>. When we define objects of this type, we supply a pointer to the operation we intend to use. In this case, we supply a pointer to <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code>:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bookstore</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">can have several transactions with the same</span></span></span>
<span><span class="calibre50">ISBN</span></span><br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">elements in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bookstore</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">will be in</span></span></span>
<span><span class="calibre50">ISBN</span></span>
<span><span class="calibre45"><span class="calibre16">order</span></span></span><br class="calibre6"/>multiset&lt;Sales_data, decltype(compareIsbn)*&gt;<br class="calibre6"/>&#160;&#160;&#160;&#160;bookstore(compareIsbn);</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Here, we use <code class="calibre23"><tt class="calibre23"><span class="calibre24">decltype</span></tt></code> to specify the type of our operation, remembering that when we use <code class="calibre23"><tt class="calibre23"><span class="calibre24">decltype</span></tt></code> to form a function pointer, we must add a <code class="calibre23"><tt class="calibre23"><span class="calibre24">*</span></tt></code> to indicate that we&#8217;re using a pointer to the given function type (&#167; <a href="069-6.7._pointers_to_functions.html#filepos1702852">6.7</a>, p. <a href="069-6.7._pointers_to_functions.html#filepos1702852">250</a>). We initialize <code class="calibre23"><tt class="calibre23"><span class="calibre24">bookstore</span></tt></code> from <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code>, which means that when we add elements to <code class="calibre23"><tt class="calibre23"><span class="calibre24">bookstore</span></tt></code>, those elements will be ordered by calling <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code>. That is, the elements in <code class="calibre23"><tt class="calibre23"><span class="calibre24">bookstore</span></tt></code> will be ordered by their <small class="calibre48">ISBN</small> members. We can write <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code> instead of <code class="calibre23"><tt class="calibre23"><span class="calibre24">&amp;compareIsbn</span></tt></code> as the constructor argument because when we use the name of a function, it is automatically converted into a pointer if needed (&#167; <a href="069-6.7._pointers_to_functions.html#filepos1702852">6.7</a>, p. <a href="069-6.7._pointers_to_functions.html#filepos1702852">248</a>). We could have written <code class="calibre23"><tt class="calibre23"><span class="calibre24">&amp;compareIsbn</span></tt></code> with the same effect.</p><div class="calibre15">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 11.2.2</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.9:</strong> Define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> that associates words with a <code class="calibre23"><tt class="calibre23"><span class="calibre24">list</span></tt></code> of line numbers on which the word might occur.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.10:</strong> Could we define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> from <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector&lt;int&gt;::iterator</span></tt></code> to <code class="calibre23"><tt class="calibre23"><span class="calibre24">int</span></tt></code>? What about from <code class="calibre23"><tt class="calibre23"><span class="calibre24">list&lt;int&gt;::iterator</span></tt></code> to <code class="calibre23"><tt class="calibre23"><span class="calibre24">int</span></tt></code>? In each case, if not, why not?</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.11:</strong> Redefine <code class="calibre23"><tt class="calibre23"><span class="calibre24">bookstore</span></tt></code> without using <code class="calibre23"><tt class="calibre23"><span class="calibre24">decltype</span></tt></code>.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h4 id="filepos2764131" class="calibre37"><span class="calibre5">11.2.3. The <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">pair</span></span></tt></span></span></tt></code> Type</span></h4><div class="calibre38">&#160;</div>
<p class="calibre14">Before we look at the operations on associative containers, we need to know about the library type named <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5"><a id="filepos2764575" href="112-defined_terms.html#filepos2894751">pair</a></span></span></tt></span></span></tt></code>, which is defined in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">utility</span></tt></code> header.</p><div class="calibre15">&#160;</div>
<p class="calibre25">A <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> holds two data members. Like the containers, <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> is a template from which we generate specific types. We must supply two type names when we create a <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>. The data members of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> have the corresponding types. There is no requirement that the two types be the same:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">pair&lt;string, string&gt; anon;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">holds two</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">string</span></span></tt></span><span><span class="calibre45"><span class="calibre16">s</span></span></span><br class="calibre6"/>pair&lt;string, size_t&gt; word_count; // <span><span class="calibre45"><span class="calibre16">holds a</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">string</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">and an</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">size_t</span></span></tt></span><br class="calibre6"/>pair&lt;string, vector&lt;int&gt;&gt; line;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">holds</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">string</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">and</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">vector&lt;int&gt;</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14"><a id="filepos2766699"/>The default <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> constructor value initializes (&#167; <a href="032-3.3._library_vector_type.html#filepos744172">3.3.1</a>, p. <a href="032-3.3._library_vector_type.html#filepos744172">98</a>) the data members. Thus, <code class="calibre23"><tt class="calibre23"><span class="calibre24">anon</span></tt></code> is a <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> of two empty <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>s, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code> holds an empty <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> and an empty <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code>. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">size_t</span></tt></code> value in <code class="calibre23"><tt class="calibre23"><span class="calibre24">word_count</span></tt></code> gets the value 0, and the <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> member is initialized to the empty <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>.</p><div class="calibre15">&#160;</div>
<p class="calibre25">We can also provide initializers for each member:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">pair&lt;string, string&gt; author{"James", "Joyce"};</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre25">creates a <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> named <code class="calibre23"><tt class="calibre23"><span class="calibre24">author</span></tt></code>, initialized with the values "<code class="calibre23"><tt class="calibre23"><span class="calibre24">James</span></tt></code>" and "<code class="calibre23"><tt class="calibre23"><span class="calibre24">Joyce</span></tt></code>".</p><div class="calibre22">&#160;</div>
<p class="calibre25">Unlike other library types, the data members of <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> are <code class="calibre23"><tt class="calibre23"><span class="calibre24">public</span></tt></code> (&#167; <a href="074-7.2._access_control_and_encapsulation.html#filepos1833387">7.2</a>, p. <a href="074-7.2._access_control_and_encapsulation.html#filepos1833387">268</a>). These members are named <code class="calibre23"><tt class="calibre23"><span class="calibre24">first</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">second</span></tt></code>, respectively. We access these members using the normal member access notation (&#167; <a href="015-1.5._introducing_classes.html#filepos237516">1.5.2</a>, p. <a href="015-1.5._introducing_classes.html#filepos237516">23</a>), as, for example, we did in the output statement of our word-counting program on page <a href="107-11.1._using_an_associative_container.html#filepos2725651">421</a>:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">print the results</span></span></span><br class="calibre6"/>cout &lt;&lt;&#160;&#160;w.first &lt;&lt; " occurs " &lt;&lt; w.second<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&lt;&lt; ((w.second &gt; 1) ? " times" : " time") &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Here, <code class="calibre23"><tt class="calibre23"><span class="calibre24">w</span></tt></code> is a reference to an element in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code>. Elements in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> are <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>s. In this statement we print the <code class="calibre23"><tt class="calibre23"><span class="calibre24">first</span></tt></code> member of the element, which is the key, followed by the <code class="calibre23"><tt class="calibre23"><span class="calibre24">second</span></tt></code> member, which is the counter. The library defines only a limited number of operations on <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>s, which are listed in <a href="108-11.2._overview_of_the_associative_containers.html#filepos2770819">Table 11.2</a>.</p><div class="calibre15">&#160;</div>
<p class="calibre51"><span class="calibre5"><a id="filepos2770819"/>Table 11.2. Operations on <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">pair</span></span></tt></span></span></tt></code>s</span></p><div class="calibre12">&#160;</div>
<div class="calibre52"><img alt="Image" src="images/00081.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<h5 class="calibre39"><span class="calibre5">A Function to Create <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">pair</span></span></tt></span></span></tt></code> Objects</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">Imagine we have a function that needs to return a <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>. Under the new standard we can list initialize the return value (&#167; <a href="065-6.3._return_types_and_the_return_statement.html#filepos1552941">6.3.2</a>, p. <a href="065-6.3._return_types_and_the_return_statement.html#filepos1552941">226</a>):</p><div class="calibre15">&#160;</div>
<div class="calibre28"><a id="filepos2771673"/><img alt="Image" src="images/00008.jpg" class="calibre9"/></div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"><a id="filepos2771765"/></span></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">pair&lt;string, int&gt;<br class="calibre6"/>process(vector&lt;string&gt; &amp;v)<br class="calibre6"/>{<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">process</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">v</span></span></tt></span><br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;if (!v.empty())<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return {v.back(), v.back().size()}; // <span><span class="calibre45"><span class="calibre16">list initialize</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;else<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return pair&lt;string, int&gt;(); // <span><span class="calibre45"><span class="calibre16">explicitly constructed return value</span></span></span><br class="calibre6"/>}</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">If <code class="calibre23"><tt class="calibre23"><span class="calibre24">v</span></tt></code> isn&#8217;t empty, we return a <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> composed of the last <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> in <code class="calibre23"><tt class="calibre23"><span class="calibre24">v</span></tt></code> and the size of that <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>. Otherwise, we explicitly construct and return an empty <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>.</p><div class="calibre15">&#160;</div>
<p class="calibre25">Under earlier versions of C++, we couldn&#8217;t use braced initializers to return a type like <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>. Instead, we might have written both returns to explicitly construct the return value:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">if (!v.empty())<br class="calibre6"/>&#160;&#160;&#160;&#160;return pair&lt;string, int&gt;(v.back(), v.back().size());</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Alternatively, we could have used <code class="calibre23"><tt class="calibre23"><span class="calibre24">make_pair</span></tt></code> to generate a new <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> of the appropriate type from its two arguments:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">if (!v.empty())<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;return make_pair(v.back(), v.back().size());</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 11.2.3</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.12:</strong> Write a program to read a sequence of <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>s and <code class="calibre23"><tt class="calibre23"><span class="calibre24">int</span></tt></code>s, storing each into a <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>. Store the <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>s in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code>.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.13:</strong> There are at least three ways to create the <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>s in the program for the previous exercise. Write three versions of that program, creating the <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code>s in each way. Explain which form you think is easiest to write and understand, and why.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 11.14:</strong> Extend the <code class="calibre23"><tt class="calibre23"><span class="calibre24">map</span></tt></code> of children to their family name that you wrote for the exercises in &#167; <a href="108-11.2._overview_of_the_associative_containers.html#filepos2741390">11.2.1</a> (p. <a href="108-11.2._overview_of_the_associative_containers.html#filepos2741390">424</a>) by having the <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> store a <code class="calibre23"><tt class="calibre23"><span class="calibre24">pair</span></tt></code> that holds a child&#8217;s name and birthday.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="107-11.1._using_an_associative_container.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="109-11.3._operations_on_associative_containers.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table></body></html>
