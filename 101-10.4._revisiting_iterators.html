<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>10.4. Revisiting Iterators</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="page_styles.css" type="text/css" rel="stylesheet"/>
</head>
  <body class="calibre">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="100-10.3._customizing_operations.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="102-10.5._structure_of_generic_algorithms.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table><h3 id="filepos2617947" class="calibre29"><span class="bold">10.4. Revisiting Iterators</span></h3><div class="calibre12">&#160;</div>
<p class="calibre14">In addition to the iterators that are defined for each of the containers, the library defines several additional kinds of iterators in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">iterator</span></tt></code> header. These iterators include</p><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <strong class="calibre5">Insert iterators</strong>: These iterators are bound to a container and can be used to insert elements into the container.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <strong class="calibre5"><a id="filepos2618641" href="105-defined_terms.html#filepos2718194">Stream iterators</a></strong>: These iterators are bound to input or output streams and can be used to iterate through the associated IO stream.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <strong class="calibre5"><a id="filepos2618932" href="105-defined_terms.html#filepos2717790">Reverse iterators</a></strong>: These iterators move backward, rather than forward. The library containers, other than <code class="calibre23"><tt class="calibre23"><span class="calibre24">forward_list</span></tt></code>, have reverse iterators.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <strong class="calibre5"><a id="filepos2619298" href="105-defined_terms.html#filepos2715882">Move iterators</a></strong>: These special-purpose iterators move rather than copy their elements. We&#8217;ll cover move iterators in &#167; <a href="126-13.6._moving_objects.html#filepos3443291">13.6.2</a> (p. <a href="126-13.6._moving_objects.html#filepos3443291">543</a>).</p></blockquote><div class="calibre15">&#160;</div>
<h4 id="filepos2619592" class="calibre37"><span class="calibre5">10.4.1. Insert Iterators</span></h4><div class="calibre38">&#160;</div>
<div class="calibre28"><img alt="Image" src="images/00009.jpg" class="calibre9"/></div>
<p class="calibre14">An inserter is an iterator adaptor (&#167; <a href="094-9.6._container_adaptors.html#filepos2426063">9.6</a>, p. <a href="094-9.6._container_adaptors.html#filepos2426063">368</a>) that takes a container and yields an iterator that adds elements to the specified container. When we assign a value through an insert iterator, the iterator calls a container operation to add an element at a specified position in the given container. The operations these iterators support are listed in <a href="101-10.4._revisiting_iterators.html#filepos2620314">Table 10.2</a> (overleaf).</p><div class="calibre15">&#160;</div>
<p class="calibre51"><span class="calibre5"><a id="filepos2620314"/>Table 10.2. Insert Iterator Operations</span></p><div class="calibre12">&#160;</div>
<div class="calibre52"><img alt="Image" src="images/00072.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<p class="calibre14"><a id="filepos2620513"/>There are three kinds of inserters. Each differs from the others as to where elements are inserted:</p><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24">back_inserter</span></tt></code> (&#167; <a href="099-10.2._a_first_look_at_the_algorithms.html#filepos2485637">10.2.2</a>, p. <a href="099-10.2._a_first_look_at_the_algorithms.html#filepos2485637">382</a>) creates an iterator that uses <code class="calibre23"><tt class="calibre23"><span class="calibre24">push_back</span></tt></code>.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5"><a id="filepos2621152" href="105-defined_terms.html#filepos2712431">front_inserter</a></span></span></tt></span></span></tt></code> creates an iterator that uses <code class="calibre23"><tt class="calibre23"><span class="calibre24">push_front</span></tt></code>.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5"><a id="filepos2621543" href="105-defined_terms.html#filepos2713561">inserter</a></span></span></tt></span></span></tt></code> creates an iterator that uses <code class="calibre23"><tt class="calibre23"><span class="calibre24">insert</span></tt></code>. This function takes a second argument, which must be an iterator into the given container. Elements are inserted ahead of the element denoted by the given iterator.</p></blockquote><div class="calibre15">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00012.jpg" class="calibre9"/> Note</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">We can use <code class="calibre23"><tt class="calibre23"><span class="calibre24">front_inserter</span></tt></code>
<em class="calibre16">only</em> if the container has <code class="calibre23"><tt class="calibre23"><span class="calibre24">push_front</span></tt></code>. Similarly, we can use <code class="calibre23"><tt class="calibre23"><span class="calibre24">back_inserter</span></tt></code>
<em class="calibre16">only</em> if it has <code class="calibre23"><tt class="calibre23"><span class="calibre24">push_back</span></tt></code>.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<p class="calibre25">It is important to understand that when we call <code class="calibre23"><tt class="calibre23"><span class="calibre24">inserter(c, iter)</span></tt></code>, we get an iterator that, when used successively, inserts elements ahead of the element originally denoted by <code class="calibre23"><tt class="calibre23"><span class="calibre24">iter</span></tt></code>. That is, if <code class="calibre23"><tt class="calibre23"><span class="calibre24">it</span></tt></code> is an iterator generated by <code class="calibre23"><tt class="calibre23"><span class="calibre24">inserter</span></tt></code>, then an assignment such as</p><div class="calibre22">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">* it = va1;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">behaves as</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">it = c.insert(it, val); // <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">it</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">points to the newly added element</span></span></span><br class="calibre6"/>++it; // <span><span class="calibre45"><span class="calibre16">increment</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">it</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">so that it denotes the same element as before</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre25">The iterator generated by <code class="calibre23"><tt class="calibre23"><span class="calibre24">front_inserter</span></tt></code> behaves quite differently from the one created by <code class="calibre23"><tt class="calibre23"><span class="calibre24">inserter</span></tt></code>. When we use <code class="calibre23"><tt class="calibre23"><span class="calibre24">front_inserter</span></tt></code>, elements are always inserted ahead of the then first element in the container. Even if the position we pass to <code class="calibre23"><tt class="calibre23"><span class="calibre24">inserter</span></tt></code> initially denotes the first element, as soon as we insert an element in front of that element, that element is no longer the one at the beginning of the container:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">list&lt;int&gt; 1st = {1,2,3,4};<br class="calibre6"/>list&lt;int&gt; lst2, lst3;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">empty lists</span></span></span><br class="calibre6"/>// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">after</span></span></tt></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">copy</span></span></tt></span>&#160;&#160;<span><span class="calibre45"><span class="calibre16">completes,</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1st2</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">contains 4 3 2 1</span></span></span><br class="calibre6"/>copy(1st.cbegin(), lst.cend(), front_inserter(lst2));<br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">after</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">copy</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">completes,</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1st3</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">contains 1 2 3 4</span></span></span><br class="calibre6"/>copy(1st.cbegin(), lst.cend(), inserter(lst3, lst3.begin()));</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">When we call <code class="calibre23"><tt class="calibre23"><span class="calibre24">front_inserter(c)</span></tt></code>, we get an insert iterator that successively calls <code class="calibre23"><tt class="calibre23"><span class="calibre24">push_front</span></tt></code>. As each element is inserted, it becomes the new first element in <code class="calibre23"><tt class="calibre23"><span class="calibre24">c</span></tt></code>. Therefore, <code class="calibre23"><tt class="calibre23"><span class="calibre24">front_inserter</span></tt></code> yields an iterator that reverses the order of the sequence that it inserts; <code class="calibre23"><tt class="calibre23"><span class="calibre24">inserter</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">back_inserter</span></tt></code> don&#8217;t.</p><div class="calibre15">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><a id="filepos2627070"/><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 10.4.1</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.26:</strong> Explain the differences among the three kinds of insert iterators.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.27:</strong> In addition to <code class="calibre23"><tt class="calibre23"><span class="calibre24">unique</span></tt></code> (&#167; <a href="099-10.2._a_first_look_at_the_algorithms.html#filepos2506543">10.2.3</a>, p. <a href="099-10.2._a_first_look_at_the_algorithms.html#filepos2506543">384</a>), the library defines function named <code class="calibre23"><tt class="calibre23"><span class="calibre24">unique_copy</span></tt></code> that takes a third iterator denoting a destination into which to copy the unique elements. Write a program that uses <code class="calibre23"><tt class="calibre23"><span class="calibre24">unique_copy</span></tt></code> to copy the unique elements from a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> into an initially empty <code class="calibre23"><tt class="calibre23"><span class="calibre24">list</span></tt></code>.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.28:</strong> Copy a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> that holds the values from <code class="calibre23"><tt class="calibre23"><span class="calibre24">1</span></tt></code> to <code class="calibre23"><tt class="calibre23"><span class="calibre24">9</span></tt></code> inclusive, into three other containers. Use an <code class="calibre23"><tt class="calibre23"><span class="calibre24">inserter</span></tt></code>, a <code class="calibre23"><tt class="calibre23"><span class="calibre24">back_inserter</span></tt></code>, and a <code class="calibre23"><tt class="calibre23"><span class="calibre24">front_inserter</span></tt></code>, respectivly to add elements to these containers. Predict how the output sequence varies by the kind of inserter and verify your predictions by running your programs.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h4 id="filepos2629061" class="calibre37"><span class="calibre5">10.4.2. <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">iostream</span></span></tt></span></span></tt></code> Iterators</span></h4><div class="calibre38">&#160;</div>
<div class="calibre28"><img alt="Image" src="images/00010.jpg" class="calibre9"/></div>
<p class="calibre14">Even though the <code class="calibre23"><tt class="calibre23"><span class="calibre24">iostream</span></tt></code> types are not containers, there are iterators that can be used with objects of the IO types (&#167; <a href="083-8.1._the_io_classes.html#filepos2076693">8.1</a>, p. <a href="083-8.1._the_io_classes.html#filepos2076693">310</a>). An <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5"><a id="filepos2629726" href="105-defined_terms.html#filepos2713992">istream_iterator</a></span></span></tt></span></span></tt></code> (<a href="101-10.4._revisiting_iterators.html#filepos2630479">Table 10.3</a> (overleaf)) reads an input stream, and an <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5"><a id="filepos2629998" href="105-defined_terms.html#filepos2716216">ostream_iterator</a></span></span></tt></span></span></tt></code> (<a href="101-10.4._revisiting_iterators.html#filepos2630814">Table 10.4</a> (p. <a href="101-10.4._revisiting_iterators.html#filepos2630814">405</a>)) writes an output stream. These iterators treat their corresponding stream as a sequence of elements of a specified type. Using a stream iterator, we can use the generic algorithms to read data from or write data to stream objects.</p><div class="calibre15">&#160;</div>
<p class="calibre51"><span class="calibre5"><a id="filepos2630479"/>Table 10.3. <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">istream_iterator</span></span></tt></span></span></tt></code> Operations</span></p><div class="calibre12">&#160;</div>
<div class="calibre52"><img alt="Image" src="images/00073.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<p class="calibre51"><span class="calibre5"><a id="filepos2630814"/>Table 10.4. <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">ostream</span></span></tt></span></span></tt></code> Iterator Operations</span></p><div class="calibre12">&#160;</div>
<div class="calibre52"><img alt="Image" src="images/00074.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Operations on <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">istream_iterators</span></span></tt></span></span></tt></code></span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">When we create a stream iterator, we must specify the type of objects that the iterator will read or write. An <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code> uses <code class="calibre23"><tt class="calibre23"><span class="calibre24">&gt;&gt;</span></tt></code> to read a stream. Therefore, the type that an <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code> reads must have an input operator defined. When we create an <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code>, we can bind it to a stream. Alternatively, we can default initialize the iterator, which creates an iterator that we can use as the off-the-end value.</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">istream_iterator&lt;int&gt; int_it(cin);&#160;&#160;&#160;//&#160;&#160;&#160;<span><span class="calibre45"><span class="calibre16">reads</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">int</span></span></tt></span><span><span class="calibre45"><span class="calibre16">s from</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cin</span></span></tt></span><br class="calibre6"/>istream_iterator&lt;int&gt; int_eof;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#160;&#160;&#160;<span><span class="calibre45"><span class="calibre16">end iterator value</span></span></span><br class="calibre6"/>ifstream in("afile");<br class="calibre6"/>istream_iterator&lt;string&gt; str_it(in); //&#160;&#160;&#160;<span><span class="calibre45"><span class="calibre16">reads</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">string</span></span></tt></span><span><span class="calibre45"><span class="calibre16">s from</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">"afile"</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">As an example, we can use an <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code> to read the standard input into a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code>:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">istream_iterator&lt;int&gt; in_iter(cin);&#160;&#160;// <span><span class="calibre45"><span class="calibre16">read</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">int</span></span></tt></span><span><span class="calibre45"><span class="calibre16">s</span></span></span>
<span><span class="calibre45"><span class="calibre16">from</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cin</span></span></tt></span><br class="calibre6"/>istream_iterator&lt;int&gt; eof;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">istream</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">''end'' iterator</span></span></span><br class="calibre6"/>while (in_iter != eof)&#160;&#160;// <span><span class="calibre45"><span class="calibre16">while there's valid input to read</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">postfix increment reads the stream and returns the old value of the iterator</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">we dereference that iterator to get the previous value read from the stream</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;vec.push_back(*in_iter++);</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">This loop reads <code class="calibre23"><tt class="calibre23"><span class="calibre24">int</span></tt></code>s from <code class="calibre23"><tt class="calibre23"><span class="calibre24">cin</span></tt></code>, storing what was read in <code class="calibre23"><tt class="calibre23"><span class="calibre24">vec</span></tt></code>. On each iteration, the loop checks whether <code class="calibre23"><tt class="calibre23"><span class="calibre24">in_iter</span></tt></code> is the same as <code class="calibre23"><tt class="calibre23"><span class="calibre24">eof</span></tt></code>. That iterator was defined as the empty <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code>, which is used as the end iterator. An iterator <a id="filepos2635704"/>bound to a stream is equal to the end iterator once its associated stream hits end-of-file or encounters an IO error.</p><div class="calibre15">&#160;</div>
<p class="calibre25">The hardest part of this program is the argument to <code class="calibre23"><tt class="calibre23"><span class="calibre24">push_back</span></tt></code>, which uses the dereference and postfix increment operators. This expression works just like others we&#8217;ve written that combined dereference with postfix increment (&#167; <a href="043-4.5._increment_and_decrement_operators.html#filepos1087530">4.5</a>, p. <a href="043-4.5._increment_and_decrement_operators.html#filepos1087530">148</a>). The postfix increment advances the stream by reading the next value but returns the <em class="calibre16">old</em> value of the iterator. That old value contains the previous value read from the stream. We dereference that iterator to obtain that value.</p><div class="calibre22">&#160;</div>
<p class="calibre25">What is more useful is that we can rewrite this program as</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">istream_iterator&lt;int&gt; in_iter(cin), eof;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">read</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">int</span></span></tt></span><span><span class="calibre45"><span class="calibre16">s</span></span></span>
<span><span class="calibre45"><span class="calibre16">from</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cin</span></span></tt></span><br class="calibre6"/>vector&lt;int&gt; vec(in_iter, eof);&#160;&#160;// <span><span class="calibre45"><span class="calibre16">construct</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">vec</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">from an iterator range</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Here we construct <code class="calibre23"><tt class="calibre23"><span class="calibre24">vec</span></tt></code> from a pair of iterators that denote a range of elements. Those iterators are <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code>s, which means that the range is obtained by reading the associated stream. This constructor reads <code class="calibre23"><tt class="calibre23"><span class="calibre24">cin</span></tt></code> until it hits end-of-file or encounters an input that is not an <code class="calibre23"><tt class="calibre23"><span class="calibre24">int</span></tt></code>. The elements that are read are used to construct <code class="calibre23"><tt class="calibre23"><span class="calibre24">vec</span></tt></code>.</p><div class="calibre15">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Using Stream Iterators with the Algorithms</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">Because algorithms operate in terms of iterator operations, and the stream iterators support at least some iterator operations, we can use stream iterators with at least some of the algorithms. We&#8217;ll see in &#167; <a href="102-10.5._structure_of_generic_algorithms.html#filepos2673303">10.5.1</a> (p. <a href="102-10.5._structure_of_generic_algorithms.html#filepos2673303">410</a>) how to tell which algorithms can be used with the stream iterators. As one example, we can call <code class="calibre23"><tt class="calibre23"><span class="calibre24">accumulate</span></tt></code> with a pair of <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterators</span></tt></code>:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">istream_iterator&lt;int&gt; in(cin), eof;<br class="calibre6"/>cout &lt;&lt; accumulate(in, eof, 0) &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">This call will generate the sum of values read from the standard input. If the input to this program is</p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">23 109 45 89 6 34 12 90 34 23 56 23 8 89 23</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">then the output will be <code class="calibre23"><tt class="calibre23"><span class="calibre24">664</span></tt></code>.</p><div class="calibre15">&#160;</div>
<h5 class="calibre39"><span class="calibre5"><a id="filepos2640063"/><code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">istream_iterator</span></span></tt></span></span></tt></code>s Are Permitted to Use Lazy Evaluation</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">When we bind an <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code> to a stream, we are not guaranteed that it will read the stream immediately. The implementation is permitted to delay reading the stream until we use the iterator. We are guaranteed that before we dereference the iterator for the first time, the stream will have been read. For most programs, whether the read is immediate or delayed makes no difference. However, if we create an <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code> that we destroy without using or if we are synchronizing reads to the same stream from two different objects, then we might care a great deal when the read happens.</p><div class="calibre15">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Operations on <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">ostream_iterator</span></span></tt></span></span></tt></code>s</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">An <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code> can be defined for any type that has an output operator (the <code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;&lt;</span></tt></code> operator). When we create an <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code>, we may (optionally) provide a second argument that specifies a character string to print following each element. That string must be a C-style character string (i.e., a string literal or a pointer to a null-terminated array). We must bind an <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code> to a specific stream. There is no empty or off-the-end <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code>.</p><div class="calibre15">&#160;</div>
<p class="calibre14">We can use an <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code> to write a sequence of values:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">ostream_iterator&lt;int&gt; out_iter(cout, " ");<br class="calibre6"/>for (auto e : vec)<br class="calibre6"/>&#160;&#160;&#160;&#160;*out_iter++ = e;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">the assignment writes this element to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cout</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">This program writes each element from <code class="calibre23"><tt class="calibre23"><span class="calibre24">vec</span></tt></code> onto <code class="calibre23"><tt class="calibre23"><span class="calibre24">cout</span></tt></code> following each element with a space. Each time we assign a value to <code class="calibre23"><tt class="calibre23"><span class="calibre24">out_iter</span></tt></code>, the write is committed.</p><div class="calibre15">&#160;</div>
<p class="calibre25">It is worth noting that we can omit the dereference and the increment when we assign to <code class="calibre23"><tt class="calibre23"><span class="calibre24">out_iter</span></tt></code>. That is, we can write this loop equivalently as</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">for (auto e : vec)<br class="calibre6"/>&#160;&#160;&#160;&#160;out_iter = e;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">the assignment writes this element to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cout</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">The <code class="calibre23"><tt class="calibre23"><span class="calibre24">*</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">++</span></tt></code> operators do nothing on an <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code>, so omitting them has no effect on our program. However, we prefer to write the loop as first presented. That loop uses the iterator consistently with how we use other iterator <a id="filepos2644645"/>types. We can easily change this loop to execute on another iterator type. Moreover, the behavior of this loop will be clearer to readers of our code.</p><div class="calibre15">&#160;</div>
<p class="calibre25">Rather than writing the loop ourselves, we can more easily print the elements in <code class="calibre23"><tt class="calibre23"><span class="calibre24">vec</span></tt></code> by calling <code class="calibre23"><tt class="calibre23"><span class="calibre24">copy</span></tt></code>:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">copy(vec.begin(), vec.end(), out_iter);<br class="calibre6"/>cout &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Using Stream Iterators with Class Types</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">We can create an <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code> for any type that has an input operator (<code class="calibre23"><tt class="calibre23"><span class="calibre24">&gt;&gt;</span></tt></code>). Similarly, we can define an <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code> so long as the type has an output operator (<code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;&lt;</span></tt></code>). Because <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_item</span></tt></code> has both input and output operators, we can use IO iterators to rewrite the bookstore program from &#167; <a href="016-1.6._the_bookstore_program.html#filepos244566">1.6</a> (p. <a href="016-1.6._the_bookstore_program.html#filepos244566">24</a>):</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">istream_iterator&lt;Sales_item&gt; item_iter(cin), eof;<br class="calibre6"/>ostream_iterator&lt;Sales_item&gt; out_iter(cout, "\n");<br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">store the first transaction in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sum</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">and read the next record</span></span></span><br class="calibre6"/>Sales_item sum = *item_iter++;<br class="calibre6"/>while (item_iter != eof) {<br class="calibre6"/>&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">if the current transaction (which is stored in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">item_iter</span></span></tt></span><span><span class="calibre45"><span class="calibre16">) has the same</span></span></span>&#160;<span><span class="calibre50">ISBN</span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;if (item_iter-&gt;isbn() == sum.isbn())<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sum += *item_iter++; // <span><span class="calibre45"><span class="calibre16">add it to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sum</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">and read the next transaction</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;else {<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;out_iter = sum;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">write the current</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sum</span></span></tt></span><br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sum = *item_iter++;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">read the next transaction</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;}<br class="calibre6"/>}<br class="calibre6"/>out_iter = sum;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">remember to print the last set of records</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">This program uses <code class="calibre23"><tt class="calibre23"><span class="calibre24">item_iter</span></tt></code> to read <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_item</span></tt></code> transactions from <code class="calibre23"><tt class="calibre23"><span class="calibre24">cin</span></tt></code>. It uses <code class="calibre23"><tt class="calibre23"><span class="calibre24">out_iter</span></tt></code> to write the resulting sums to <code class="calibre23"><tt class="calibre23"><span class="calibre24">cout</span></tt></code>, following each output with a newline. Having defined our iterators, we use <code class="calibre23"><tt class="calibre23"><span class="calibre24">item_iter</span></tt></code> to initialize <code class="calibre23"><tt class="calibre23"><span class="calibre24">sum</span></tt></code> with the value of the first transaction:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">store the first transaction in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sum</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">and read the next record</span></span></span><br class="calibre6"/>Sales_item sum = *item_iter++;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Here, we dereference the result of the postfix increment on <code class="calibre23"><tt class="calibre23"><span class="calibre24">item_iter</span></tt></code>. This expression reads the next transaction, and initializes <code class="calibre23"><tt class="calibre23"><span class="calibre24">sum</span></tt></code> from the value previously stored in <code class="calibre23"><tt class="calibre23"><span class="calibre24">item_iter</span></tt></code>.</p><div class="calibre15">&#160;</div>
<p class="calibre14">The <code class="calibre23"><tt class="calibre23"><span class="calibre24">while</span></tt></code> loop executes until we hit end-of-file on <code class="calibre23"><tt class="calibre23"><span class="calibre24">cin</span></tt></code>. Inside the <code class="calibre23"><tt class="calibre23"><span class="calibre24">while</span></tt></code>, we check whether <code class="calibre23"><tt class="calibre23"><span class="calibre24">sum</span></tt></code> and the record we just read refer to the same book. If so, we add the most recently read <code class="calibre23"><tt class="calibre23"><span class="calibre24">Sales_item</span></tt></code> into <code class="calibre23"><tt class="calibre23"><span class="calibre24">sum</span></tt></code>. If the <small class="calibre48">ISBN</small>s differ, we assign <code class="calibre23"><tt class="calibre23"><span class="calibre24">sum</span></tt></code> to <code class="calibre23"><tt class="calibre23"><span class="calibre24">out_iter</span></tt></code>, which prints the current value of <code class="calibre23"><tt class="calibre23"><span class="calibre24">sum</span></tt></code> followed by a newline. Having printed the sum for the previous book, we assign <code class="calibre23"><tt class="calibre23"><span class="calibre24">sum</span></tt></code> a copy of the most recently read transaction and increment the iterator, which reads the next transaction. The loop continues until an error or end-of-file is encountered. Before exiting, we remember to print the values associated with the last book in the input.</p><div class="calibre15">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><a id="filepos2651608"/><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 10.4.2</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.29:</strong> Write a program using stream iterators to read a text file into a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> of <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>s.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.30:</strong> Use stream iterators, <code class="calibre23"><tt class="calibre23"><span class="calibre24">sort</span></tt></code>, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">copy</span></tt></code> to read a sequence of integers from the standard input, sort them, and then write them back to the standard output.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.31:</strong> Update the program from the previous exercise so that it prints only the unique elements. Your program should use <code class="calibre23"><tt class="calibre23"><span class="calibre24">unqiue_copy</span></tt></code> (&#167; <a href="101-10.4._revisiting_iterators.html#filepos2619592">10.4.1</a>, p. <a href="101-10.4._revisiting_iterators.html#filepos2619592">403</a>).</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.32:</strong> Rewrite the bookstore problem from &#167; <a href="016-1.6._the_bookstore_program.html#filepos244566">1.6</a> (p. <a href="016-1.6._the_bookstore_program.html#filepos244566">24</a>) using a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> to hold the transactions and various algorithms to do the processing. Use <code class="calibre23"><tt class="calibre23"><span class="calibre24">sort</span></tt></code> with your <code class="calibre23"><tt class="calibre23"><span class="calibre24">compareIsbn</span></tt></code> function from &#167; <a href="100-10.3._customizing_operations.html#filepos2520495">10.3.1</a> (p. <a href="100-10.3._customizing_operations.html#filepos2520495">387</a>) to arrange the transactions in order, and then use <code class="calibre23"><tt class="calibre23"><span class="calibre24">find</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">accumulate</span></tt></code> to do the sum.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.33:</strong> Write a program that takes the names of an input file and two output files. The input file should hold integers. Using an <code class="calibre23"><tt class="calibre23"><span class="calibre24">istream_iterator</span></tt></code> read the input file. Using <code class="calibre23"><tt class="calibre23"><span class="calibre24">ostream_iterator</span></tt></code>s, write the odd numbers into the first output file. Each value should be followed by a space. Write the even numbers into the second file. Each of these values should be placed on a separate line.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h4 id="filepos2654416" class="calibre37"><span class="calibre5">10.4.3. Reverse Iterators</span></h4><div class="calibre38">&#160;</div>
<p class="calibre14">A reverse iterator is an iterator that traverses a container backward, from the last element toward the first. A reverse iterator inverts the meaning of increment (and decrement). Incrementing (<code class="calibre23"><tt class="calibre23"><span class="calibre24">++it</span></tt></code>) a reverse iterator moves the iterator to the previous element; derementing <code class="calibre23"><tt class="calibre23"><span class="calibre24">(--it</span></tt></code>) moves the iterator to the next element.</p><div class="calibre15">&#160;</div>
<p class="calibre25">The containers, aside from <code class="calibre23"><tt class="calibre23"><span class="calibre24">forward_list</span></tt></code>, all have reverse iterators. We obtain a reverse iterator by calling the <code class="calibre23"><tt class="calibre23"><span class="calibre24">rbegin</span></tt></code>, <code class="calibre23"><tt class="calibre23"><span class="calibre24">rend</span></tt></code>, <code class="calibre23"><tt class="calibre23"><span class="calibre24">crbegin</span></tt></code>, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">crend</span></tt></code> members. These members return reverse iterators to the last element in the container and one &#8220;past&#8221; (i.e., one before) the beginning of the container. As with ordinary iterators, there are both <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> and non<code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> reverse iterators.</p><div class="calibre22">&#160;</div>
<p class="calibre25"><a href="101-10.4._revisiting_iterators.html#filepos2656256">Figure 10.1</a> illustrates the relationship between these four iterators on a hypothetical <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> named <code class="calibre23"><tt class="calibre23"><span class="calibre24">vec</span></tt></code>.</p><div class="calibre22">&#160;</div>
<div class="calibre52"><a id="filepos2656256"/><img alt="Image" src="images/00075.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<p class="calibre51"><span class="calibre5">Figure 10.1. Comparing <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">begin/cend</span></span></tt></span></span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">rbegin/crend</span></span></tt></span></span></tt></code> Iterators</span></p><div class="calibre12">&#160;</div>
<p class="calibre25">As an example, the following loop prints the elements of <code class="calibre23"><tt class="calibre23"><span class="calibre24">vec</span></tt></code> in reverse order:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"><a id="filepos2656969"/></span></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">vector&lt;int&gt; vec = {0,1,2,3,4,5,6,7,8,9};<br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">reverse iterator of</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">vector</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">from back to front</span></span></span><br class="calibre6"/>for (auto r_iter = vec.crbegin(); // <span><span class="calibre45"><span class="calibre16">binds</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">r_iter</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">to the last element</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;r_iter != vec.crend();&#160;&#160;// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">crend</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">refers 1 before 1st element</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;++r_iter)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">decrements the iterator one element</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;cout &lt;&lt; *r_iter &lt;&lt; endl;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">prints</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">9, 8, 7</span></span></tt></span>,<span><span class="calibre45"><span class="calibre16">...</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre25">Although it may seem confusing to have the meaning of the increment and decrement operators reversed, doing so lets us use the algorithms transparently to process a container forward or backward. For example, we can sort our <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> in descending order by passing <code class="calibre23"><tt class="calibre23"><span class="calibre24">sort</span></tt></code> a pair of reverse iterators:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">sort(vec.begin(), vec.end()); // <span><span class="calibre45"><span class="calibre16">sorts</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">vec</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">''normal'' order</span></span></tt></span><br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">sorts in reverse: puts the smallest element at the end of</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">vec</span></span></tt></span><br class="calibre6"/>sort(vec.rbegin(), vec.rend());</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Reverse Iterators Require Decrement Operators</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">Not surprisingly, we can define a reverse iterator only from an iterator that supports <code class="calibre23"><tt class="calibre23"><span class="calibre24">--</span></tt></code> as well as <code class="calibre23"><tt class="calibre23"><span class="calibre24">++</span></tt></code>. After all, the purpose of a reverse iterator is to move the iterator backward through the sequence. Aside from <code class="calibre23"><tt class="calibre23"><span class="calibre24">forward_list</span></tt></code>, the iterators on the standard containers all support decrement as well as increment. However, the stream iterators do not, because it is not possible to move backward through a stream. Therefore, it is not possible to create a reverse iterator from a <code class="calibre23"><tt class="calibre23"><span class="calibre24">forward_list</span></tt></code> or a stream iterator.</p><div class="calibre15">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Relationship between Reverse Iterators and Other Iterators</span></h5><div class="calibre38">&#160;</div>
<div class="calibre28"><img alt="Image" src="images/00011.jpg" class="calibre9"/></div>
<p class="calibre14">Suppose we have a <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> named <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code> that contains a comma-separated list of words, and we want to print the first word in <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code>. Using <code class="calibre23"><tt class="calibre23"><span class="calibre24">find</span></tt></code>, this task is easy:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">find the first element in a comma-separated list</span></span></span><br class="calibre6"/>auto comma = find(line.cbegin(), line.cend(), ',');<br class="calibre6"/>cout &lt;&lt; string(line.cbegin(), comma) &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">If there is a comma in <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code>, then <code class="calibre23"><tt class="calibre23"><span class="calibre24">comma</span></tt></code> refers to that comma; otherwise it is <code class="calibre23"><tt class="calibre23"><span class="calibre24">line.cend()</span></tt></code>. When we print the <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> from <code class="calibre23"><tt class="calibre23"><span class="calibre24">line.cbegin()</span></tt></code> to <code class="calibre23"><tt class="calibre23"><span class="calibre24">comma</span></tt></code>, we print characters up to the comma, or the entire <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> if there is no comma.</p><div class="calibre15">&#160;</div>
<p class="calibre25">If we wanted the last word, we can use reverse iterators instead:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">find the last element in a comma-separated list</span></span></span><br class="calibre6"/>auto rcomma = find(line.crbegin(), line.crend(), ',');</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Because we pass <code class="calibre23"><tt class="calibre23"><span class="calibre24">crbegin()</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">crend()</span></tt></code>, this call starts with the last character in <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code> and searches backward. When <code class="calibre23"><tt class="calibre23"><span class="calibre24">find</span></tt></code> completes, if there is a comma, then <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma</span></tt></code> refers to the last comma in the line&#8212;that is, it refers to the first comma found in the backward search. If there is no comma, then <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma</span></tt></code> is <code class="calibre23"><tt class="calibre23"><span class="calibre24">line.crend()</span></tt></code>.</p><div class="calibre15">&#160;</div>
<p class="calibre25">The interesting part comes when we try to print the word we found. The seemingly obvious way</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">WRONG: will generate the word in reverse order</span></span></span><br class="calibre6"/>cout &lt;&lt; string(line.crbegin(), rcomma) &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14"><a id="filepos2664962"/>generates bogus output. For example, had our input been</p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">FIRST,MIDDLE,LAST</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">then this statement would print <code class="calibre23"><tt class="calibre23"><span class="calibre24">TSAL!</span></tt></code></p><div class="calibre15">&#160;</div>
<p class="calibre25"><a href="101-10.4._revisiting_iterators.html#filepos2667404">Figure 10.2</a> illustrates the problem: We are using reverse iterators, which process the <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> backward. Therefore, our output statement prints from <code class="calibre23"><tt class="calibre23"><span class="calibre24">crbegin</span></tt></code> backward through <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code>. Instead, we want to print from <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma</span></tt></code> forward to the end of <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code>. However, we can&#8217;t use <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma</span></tt></code> directly. That iterator is a reverse iterator, which means that it goes backward toward the beginning of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>. What we need to do is transform <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma</span></tt></code> back into an ordinary iterator that will go forward through <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code>. We can do so by calling the <code class="calibre23"><tt class="calibre23"><span class="calibre24">reverse_iterator</span></tt></code>&#8217;s <code class="calibre23"><tt class="calibre23"><span class="calibre24">base</span></tt></code> member, which gives us its corresponding ordinary iterator:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><span class="calibre45"><span class="calibre16">ok: get a forward iterator and read to the end of</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">line</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; string(rcomma.base(), line.cend()) &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<div class="calibre52"><a id="filepos2667404"/><img alt="Image" src="images/00076.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<p class="calibre51"><span class="calibre5">Figure 10.2. Relationship between Reverse and Ordinary Iterators</span></p><div class="calibre12">&#160;</div>
<p class="calibre14">Given the same preceding input, this statement prints <code class="calibre23"><tt class="calibre23"><span class="calibre24">LAST</span></tt></code> as expected.</p><div class="calibre15">&#160;</div>
<p class="calibre25">The objects shown in <a href="101-10.4._revisiting_iterators.html#filepos2667404">Figure 10.2</a> illustrate the relationship between ordinary and reverse iterators. For example, <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma.base()</span></tt></code> refer to different elements, as do <code class="calibre23"><tt class="calibre23"><span class="calibre24">line.crbegin()</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">line.cend()</span></tt></code>. These differences are needed to ensure that the <em class="calibre16">range</em> of elements, whether processed forward or backward, is the same.</p><div class="calibre22">&#160;</div>
<p class="calibre25">Technically speaking, the relationship between normal and reverse iterators accommodates the properties of a left-inclusive range (&#167; <a href="090-9.2._container_library_overview.html#filepos2196283">9.2.1</a>, p. <a href="090-9.2._container_library_overview.html#filepos2196283">331</a>). The point is that <code class="calibre23"><tt class="calibre23"><span class="calibre24">[line.crbegin(), rcomma)</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">[rcomma.base(), line.cend())</span></tt></code> refer to the same elements in <code class="calibre23"><tt class="calibre23"><span class="calibre24">line</span></tt></code>. In order for that to happen, <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">rcomma.base()</span></tt></code> must yield adjacent positions, rather than the same position, as must <code class="calibre23"><tt class="calibre23"><span class="calibre24">crbegin()</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">cend()</span></tt></code>.</p><div class="calibre22">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00012.jpg" class="calibre9"/> Note</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">The fact that reverse iterators are intended to represent ranges and that these ranges are asymmetric has an important consequence: When we initialize or assign a reverse iterator from a plain iterator, the resulting iterator does not refer to the same element as the original.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><a id="filepos2670101"/><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 10.4.3</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.34:</strong> Use <code class="calibre23"><tt class="calibre23"><span class="calibre24">reverse_iterator</span></tt></code>s to print a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> in reverse order.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.35:</strong> Now print the elements in reverse order using ordinary iterators.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.36:</strong> Use <code class="calibre23"><tt class="calibre23"><span class="calibre24">find</span></tt></code> to find the last element in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">list</span></tt></code> of <code class="calibre23"><tt class="calibre23"><span class="calibre24">int</span></tt></code>s with value 0.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 10.37:</strong> Given a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> that has ten elements, copy the elements from positions 3 through 7 in reverse order to a <code class="calibre23"><tt class="calibre23"><span class="calibre24">list</span></tt></code>.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="100-10.3._customizing_operations.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="102-10.5._structure_of_generic_algorithms.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table></body></html>
