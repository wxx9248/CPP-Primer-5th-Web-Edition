<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>4.9. The sizeof Operator</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="page_styles.css" type="text/css" rel="stylesheet"/>
</head>
  <body class="calibre">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="046-4.8._the_bitwise_operators.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="048-4.10._comma_operator.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table><h3 id="filepos1142429" class="calibre29"><span class="bold">4.9. The <code class="calibre54"><tt class="calibre54"><span class="calibre55"><span class="calibre2"><tt class="calibre54"><span class="calibre56"><span class="bold">sizeof</span></span></tt></span></span></tt></code> Operator</span></h3><div class="calibre12">&#160;</div>
<p class="calibre14">The <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5"><a id="filepos1142776" href="052-defined_terms.html#filepos1221566">sizeof</a></span></span></tt></span></span></tt></code> operator returns the size, in bytes, of an expression or a type name. The operator is right associative. The result of <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> is a constant expression (&#167; <a href="024-2.4._const_qualifier.html#filepos520427">2.4.4</a>, p. <a href="024-2.4._const_qualifier.html#filepos520427">65</a>) of type <code class="calibre23"><tt class="calibre23"><span class="calibre24">size_t</span></tt></code> (&#167; <a href="034-3.5._arrays.html#filepos873638">3.5.2</a>, p. <a href="034-3.5._arrays.html#filepos873638">116</a>). The operator takes one of two forms:</p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">sizeof (<span><span class="calibre45"><span class="calibre16">type)</span></span></span><br class="calibre6"/>sizeof <span><span class="calibre45"><span class="calibre16">expr</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">In the second form, <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> returns the size of the type returned by the given expression. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> operator is unusual in that it does not evaluate its operand:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"><a id="filepos1144067"/></span></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">Sales_data data, *p;<br class="calibre6"/>sizeof(Sales_data); // <span><span class="calibre45"><span class="calibre16">size required to hold an object of type</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">Sales_data</span></span></tt></span><br class="calibre6"/>sizeof data; // <span><span class="calibre45"><span class="calibre16">size of</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">data</span></span></tt></span><span><span class="calibre45"><span class="calibre16">'s</span></span></span>
<span><span class="calibre45"><span class="calibre16">type, i.e.,</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sizeof(Sales_data)</span></span></tt></span><br class="calibre6"/>sizeof p;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">size of a pointer</span></span></span><br class="calibre6"/>sizeof *p;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">size of the type to which</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">p</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">points, i.e.,</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sizeof(Sales_data)</span></span></tt></span><br class="calibre6"/>sizeof data.revenue; // <span><span class="calibre45"><span class="calibre16">size of the type of</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">Sales_data's revenue</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">member</span></span></span><br class="calibre6"/>sizeof Sales_data::revenue; // <span><span class="calibre45"><span class="calibre16">alternative way to get the size of</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">revenue</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">The most interesting of these examples is <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof *p</span></tt></code>. First, because <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> is right associative and has the same precedence as <code class="calibre23"><tt class="calibre23"><span class="calibre24">*</span></tt></code>, this expression groups right to left. That is, it is equivalent to <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof (*p)</span></tt></code>. Second, because <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> does not evaluate its operand, it doesn&#8217;t matter that <code class="calibre23"><tt class="calibre23"><span class="calibre24">p</span></tt></code> is an invalid (i.e., uninitialized) pointer (&#167; <a href="023-2.3._compound_types.html#filepos409391">2.3.2</a>, p. <a href="023-2.3._compound_types.html#filepos409391">52</a>). Dereferencing an invalid pointer as the operand to <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> is safe because the pointer is not actually used. <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> doesn&#8217;t need dereference the pointer to know what type it will return.</p><div class="calibre15">&#160;</div>
<p class="calibre25">Under the new standard, we can use the scope operator to ask for the size of a member of a class type. Ordinarily we can only access the members of a class through an object of that type. We don&#8217;t need to supply an object, because <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> does not need to fetch the member to know its size.</p><div class="calibre22">&#160;</div>
<div class="calibre28"><a id="filepos1147517"/><img alt="Image" src="images/00008.jpg" class="calibre9"/></div>
<p class="calibre25">The result of applying <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> depends in part on the type involved:</p><div class="calibre22">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof char</span></tt></code> or an expression of type <code class="calibre23"><tt class="calibre23"><span class="calibre24">char</span></tt></code> is guaranteed to be 1.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> a reference type returns the size of an object of the referenced type.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> a pointer returns the size needed hold a pointer.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> a dereferenced pointer returns the size of an object of the type to which the pointer points; the pointer need not be valid.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> an array is the size of the entire array. It is equivalent to taking the <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> the element type times the number of elements in the array. Note that <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> does not convert the array to a pointer.</p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre27">&#8226; <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> a <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> or a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code> returns only the size of the fixed part of these types; it does not return the size used by the object&#8217;s elements.</p></blockquote><div class="calibre15">&#160;</div>
<p class="calibre25">Because <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> returns the size of the entire array, we can determine the number of elements in an array by dividing the array size by the element size:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sizeof(ia)/sizeof(*ia</span></span></tt></span>) <span><span class="calibre45"><span class="calibre16">returns the number of elements in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">ia</span></span></tt></span><br class="calibre6"/>constexpr size_t sz = sizeof(ia)/sizeof(*ia);<br class="calibre6"/>int arr2[sz];&#160;&#160;// <span><span class="calibre45"><span class="calibre16">ok</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">sizeof</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">returns a constant expression &#167; 2.4.4 (p. 65</span></span></span>)</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Because <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> returns a constant expression, we can use the result of a <code class="calibre23"><tt class="calibre23"><span class="calibre24">sizeof</span></tt></code> expression to specify the dimension of an array.</p><div class="calibre15">&#160;</div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="046-4.8._the_bitwise_operators.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="048-4.10._comma_operator.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table></body></html>
