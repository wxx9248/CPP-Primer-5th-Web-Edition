<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>4.7. The Conditional Operator</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="page_styles.css" type="text/css" rel="stylesheet"/>
</head>
  <body class="calibre">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="044-4.6._the_member_access_operators.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="046-4.8._the_bitwise_operators.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table><h3 id="filepos1107527" class="calibre29"><span class="bold"><a id="filepos1107560" class="calibre2"/>4.7. The Conditional Operator</span></h3><div class="calibre12">&#160;</div>
<p class="calibre14">The conditional operator (the <a id="filepos1107697" href="052-defined_terms.html#filepos1222855"><code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">?:</span></span></tt></span></span></tt></code>
<strong class="calibre5">operator</strong></a>) lets us embed simple if-else logic inside an expression. The conditional operator has the following form:</p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24"><span><span class="calibre45"><span class="calibre16">cond&#160;&#160;? expr1&#160;&#160;: expr2;</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">where <em class="calibre16">cond</em> is an expression that is used as a condition and <em class="calibre16">expr1</em> and <em class="calibre16">expr2</em> are expressions of the same type (or types that can be converted to a common type). This operator executes by evaluating <em class="calibre16">cond</em>. If the condition is <code class="calibre23"><tt class="calibre23"><span class="calibre24">true</span></tt></code>, then <em class="calibre16">expr1</em> is evaluated; otherwise, <em class="calibre16">expr2</em> is evaluated. As one example, we can use a conditional operator to determine whether a grade is pass or fail:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">string finalgrade = (grade &lt; 60) ? "fail" : "pass";</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">The condition checks whether <code class="calibre23"><tt class="calibre23"><span class="calibre24">grade</span></tt></code> is less than <code class="calibre23"><tt class="calibre23"><span class="calibre24">60</span></tt></code>. If so, the result of the expression is <code class="calibre23"><tt class="calibre23"><span class="calibre24">"fail"</span></tt></code>; otherwise the result is <code class="calibre23"><tt class="calibre23"><span class="calibre24">"pass"</span></tt></code>. Like the logical <small class="calibre48">AND</small> and logical <small class="calibre48">OR</small> (<code class="calibre23"><tt class="calibre23"><span class="calibre24">&amp;&amp;</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">||</span></tt></code>) operators, the conditional operator guarantees that only one of <em class="calibre16">expr1</em> or <em class="calibre16">expr2</em> is evaluated.</p><div class="calibre15">&#160;</div>
<p class="calibre25">That result of the conditional operator is an lvalue if both expressions are lvalues or if they convert to a common lvalue type. Otherwise the result is an rvalue.</p><div class="calibre22">&#160;</div>
<h4 class="calibre37"><span class="calibre5">Nesting Conditional Operations</span></h4><div class="calibre38">&#160;</div>
<p class="calibre14">We can nest one conditional operator inside another. That is, the conditional operator can be used as the <em class="calibre16">cond</em> or as one or both of the <em class="calibre16">expr</em>s of another conditional expression. As an example, we&#8217;ll use a pair of nested conditionals to perform a three-way test to indicate whether a grade is a high pass, an ordinary pass, or fail:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">finalgrade = (grade &gt; 90) ? "high pass"<br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;: (grade &lt; 60) ? "fail" : "pass";</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">The first condition checks whether the grade is above <code class="calibre23"><tt class="calibre23"><span class="calibre24">90</span></tt></code>. If so, the expression after the <code class="calibre23"><tt class="calibre23"><span class="calibre24">?</span></tt></code> is evaluated, which yields <code class="calibre23"><tt class="calibre23"><span class="calibre24">"high pass"</span></tt></code>. If the condition fails, the <code class="calibre23"><tt class="calibre23"><span class="calibre24">:</span></tt></code> branch is executed, which is itself another conditional expression. This conditional asks whether the <code class="calibre23"><tt class="calibre23"><span class="calibre24">grade</span></tt></code> is less than <code class="calibre23"><tt class="calibre23"><span class="calibre24">60</span></tt></code>. If so, the <code class="calibre23"><tt class="calibre23"><span class="calibre24">?</span></tt></code> branch is evaluated and yields <code class="calibre23"><tt class="calibre23"><span class="calibre24">"fail"</span></tt></code>. If not, the <code class="calibre23"><tt class="calibre23"><span class="calibre24">:</span></tt></code> branch returns <code class="calibre23"><tt class="calibre23"><span class="calibre24">"pass"</span></tt></code>.</p><div class="calibre15">&#160;</div>
<p class="calibre25">The conditional operator is right associative, meaning (as usual) that the operands group right to left. Associativity accounts for the fact that the right-hand conditional&#8212;the one that compares <code class="calibre23"><tt class="calibre23"><span class="calibre24">grade</span></tt></code> to <code class="calibre23"><tt class="calibre23"><span class="calibre24">60</span></tt></code>&#8212;forms the <code class="calibre23"><tt class="calibre23"><span class="calibre24">:</span></tt></code> branch of the left-hand conditional expression.</p><div class="calibre22">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00013.jpg" class="calibre9"/> Warning</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">Nested conditionals quickly become unreadable. It&#8217;s a good idea to nest no more than two or three.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h4 class="calibre37"><span class="calibre5">Using a Conditional Operator in an Output Expression</span></h4><div class="calibre38">&#160;</div>
<p class="calibre14">The conditional operator has fairly low precedence. When we embed a conditional expression in a larger expression, we usually must parenthesize the conditional subexpression. For example, we often use the conditional operator to print one or <a id="filepos1113649"/>another value, depending on the result of a condition. An incompletely parenthesized conditional operator in an output expression can have surprising results:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">cout &lt;&lt; ((grade &lt; 60) ?&#160;&#160;&#160;"fail" : "pass"); // <span><span class="calibre45"><span class="calibre16">prints</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">pass</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">or</span></span></span>&#160;&#160;<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">fail</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; (grade &lt; 60) ?&#160;&#160;&#160;"fail" : "pass";&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">prints</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">or</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0!</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; grade &lt; 60 ?&#160;&#160;&#160;"fail" : "pass"; //&#160;&#160;<span><span class="calibre45"><span class="calibre16">error: compares</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cout</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">60</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">The second expression uses the comparison between <code class="calibre23"><tt class="calibre23"><span class="calibre24">grade</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">60</span></tt></code> as the operand to the <code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;&lt;</span></tt></code> operator. The value <code class="calibre23"><tt class="calibre23"><span class="calibre24">1</span></tt></code> or <code class="calibre23"><tt class="calibre23"><span class="calibre24">0</span></tt></code> is printed, depending on whether <code class="calibre23"><tt class="calibre23"><span class="calibre24">grade &lt; 60</span></tt></code> is true or false. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">&lt;&lt;</span></tt></code> operator returns <code class="calibre23"><tt class="calibre23"><span class="calibre24">cout</span></tt></code>, which is tested as the condition for the conditional operator. That is, the second expression is equivalent to</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">cout &lt;&lt; (grade &lt; 60);&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">prints</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">or</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span><br class="calibre6"/>cout ?&#160;&#160;"fail" : "pass"; // <span><span class="calibre45"><span class="calibre16">test</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cout</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">and then yield one of the two literals</span></span></span><br class="calibre6"/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">depending on whether</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cout</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">is</span></span></span>
<span><span class="calibre45"><span class="calibre16">true or false</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">The last expression is an error because it is equivalent to</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">cout &lt;&lt; grade;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">less-than has lower precedence than shift, so print</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">grade</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">first</span></span></span><br class="calibre6"/>cout &lt; 60 ? "fail" : "pass"; // <span><span class="calibre45"><span class="calibre16">then compare</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cout</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">60</span></span></tt></span><span><span class="calibre45"><span class="calibre16">!</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 4.7</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 4.21:</strong> Write a program to use a conditional operator to find the elements in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector&lt;int&gt;</span></tt></code> that have odd value and double the value of each such element.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 4.22:</strong> Extend the program that assigned high pass, pass, and fail grades to also assign low pass for grades between 60 and 75 inclusive. Write two versions: One version that uses only conditional operators; the other should use one or more <code class="calibre23"><tt class="calibre23"><span class="calibre24">if</span></tt></code> statements. Which version do you think is easier to understand and why?</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 4.23:</strong> The following expression fails to compile due to operator precedence. Using Table 4.12 (p. <a href="050-4.12._operator_precedence_table.html#filepos1211317">166</a>), explain why it fails. How would you fix it?</p></blockquote><div class="calibre10">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">string s = "word";<br class="calibre6"/>string pl = s + s[s.size() - 1] == 's' ? "" : "s" ;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 4.24:</strong> Our program that distinguished between high pass, pass, and fail depended on the fact that the conditional operator is right associative. Describe how that operator would be evaluated if the operator were left associative.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="044-4.6._the_member_access_operators.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="046-4.8._the_bitwise_operators.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table></body></html>
