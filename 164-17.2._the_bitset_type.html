<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>17.2. The bitset Type</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="page_styles.css" type="text/css" rel="stylesheet"/>
</head>
  <body class="calibre">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="163-17.1._the_tuple_type.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="165-17.3._regular_expressions.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table><h3 id="filepos4603212" class="calibre29"><span class="bold">17.2. The <code class="calibre54"><tt class="calibre54"><span class="calibre55"><span class="calibre2"><tt class="calibre54"><span class="calibre56"><span class="bold">bitset</span></span></tt></span></span></tt></code> Type</span></h3><div class="calibre12">&#160;</div>
<p class="calibre14">In &#167; <a href="046-4.8._the_bitwise_operators.html#filepos1120642">4.8</a> (p. <a href="046-4.8._the_bitwise_operators.html#filepos1120642">152</a>) we covered the built-in operators that treat an integral operand as a collection of bits. The standard library defines the <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5"><a id="filepos4603754" href="169-defined_terms.html#filepos4842475">bitset</a></span></span></tt></span></span></tt></code> class to make it easier to use bit operations and possible to deal with collections of bits that are larger than the longest integral type. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> class is defined in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> header.</p><div class="calibre15">&#160;</div>
<h4 id="filepos4604189" class="calibre37"><span class="calibre5">17.2.1. Defining and Initializing <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code>s</span></h4><div class="calibre38">&#160;</div>
<p class="calibre14"><a href="164-17.2._the_bitset_type.html#filepos4605799">Table 17.2</a> (overleaf) lists the constructors for <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> class is a class template that, like the <code class="calibre23"><tt class="calibre23"><span class="calibre24">array</span></tt></code> class, has a fixed size (&#167; <a href="090-9.2._container_library_overview.html#filepos2221429">9.2.4</a>, p. <a href="090-9.2._container_library_overview.html#filepos2221429">336</a>). When we define a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>, we say how many bits the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> will contain:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bitset&lt;32&gt; bitvec(1U); // <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">32</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">bits; low-order bit is <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1</span></span></tt></span>, remaining bits are</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre51"><span class="calibre5"><a id="filepos4605799"/>Table 17.2. Ways to Initialize a <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code></span></p><div class="calibre12">&#160;</div>
<div class="calibre52"><img alt="Image" src="images/00109.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<p class="calibre14">The size must be a constant expression (&#167; <a href="024-2.4._const_qualifier.html#filepos520427">2.4.4</a>, p. <a href="024-2.4._const_qualifier.html#filepos520427">65</a>). This statement defines <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitvec</span></tt></code> as a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> that holds <code class="calibre23"><tt class="calibre23"><span class="calibre24">32</span></tt></code> bits. Just as with the elements of a <code class="calibre23"><tt class="calibre23"><span class="calibre24">vector</span></tt></code>, the bits in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> are not named. Instead, we refer to them positionally. The bits are numbered starting at <code class="calibre23"><tt class="calibre23"><span class="calibre24">0</span></tt></code>. Thus, <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitvec</span></tt></code> has bits numbered <code class="calibre23"><tt class="calibre23"><span class="calibre24">0</span></tt></code> through <code class="calibre23"><tt class="calibre23"><span class="calibre24">31</span></tt></code>. The bits starting at <code class="calibre23"><tt class="calibre23"><span class="calibre24">0</span></tt></code> are referred to as the <strong class="calibre5"><a id="filepos4607189" href="169-defined_terms.html#filepos4845660">low-order</a></strong> bits, and those ending at <code class="calibre23"><tt class="calibre23"><span class="calibre24">31</span></tt></code> are referred to as <strong class="calibre5"><a id="filepos4607371" href="169-defined_terms.html#filepos4845382">high-order</a></strong> bits.</p><div class="calibre15">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Initializing a <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code> from an <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">unsigned</span></span></tt></span></span></tt></code> Value</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">When we use an integral value as an initializer for a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>, that value is converted to <code class="calibre23"><tt class="calibre23"><span class="calibre24">unsigned long long</span></tt></code> and is treated as a bit pattern. The bits in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> are a copy of that pattern. If the size of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> is greater than the number of bits in an <code class="calibre23"><tt class="calibre23"><span class="calibre24">unsigned long long</span></tt></code>, then the remaining high-order bits <a id="filepos4608500"/>are set to zero. If the size of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> is less than that number of bits, then only the low-order bits from the given value are used; the high-order bits beyond the size of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> object are discarded:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bitvec1</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">is smaller than the initializer; high-order bits from the initializer are discarded</span></span></span><br class="calibre6"/>bitset&lt;13&gt; bitvec1 (0xbeef);&#160;&#160;// <span><span class="calibre45"><span class="calibre16">bits are 1111011101111</span></span></span><br class="calibre6"/>// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bitvec2</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">is larger than the initializer; high-order bits in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bitvec2</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">are set to zero</span></span></span><br class="calibre6"/>bitset&lt;20&gt; bitvec2(0xbeef);&#160;&#160;// <span><span class="calibre45"><span class="calibre16">bits are 00001011111011101111</span></span></span><br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">on machines with 64-bit</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">long long</span></span></tt></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0ULL</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">is 64 bits of 0, so</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">~0ULL</span></span></tt></span>&#160;&#160;<span><span class="calibre45"><span class="calibre16">is 64 ones</span></span></span><br class="calibre6"/>bitset&lt;128&gt; bitvec3(~0ULL); // <span><span class="calibre45"><span class="calibre16">bits 0 ... 63 are one; 63 ... 127 are zero</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Initializing a <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code> from a <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">string</span></span></tt></span></span></tt></code></span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">We can initialize a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> from either a <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> or a pointer to an element in a character array. In either case, the characters represent the bit pattern directly. As usual, when we use strings to represent numbers, the characters with the lowest indices in the string correspond to the high-order bits, and vice versa:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bitset&lt;32&gt; bitvec4("1100"); // <span><span class="calibre45"><span class="calibre16">bits 2 and 3 are</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1</span></span></tt></span><span><span class="calibre45"><span class="calibre16">, all others are</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">If the <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> contains fewer characters than the size of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>, the high-order bits are set to zero.</p><div class="calibre15">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00012.jpg" class="calibre9"/> Note</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">The indexing conventions of <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>s and <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>s are inversely related: The character in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> with the highest subscript (the rightmost character) is used to initialize the low-order bit in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> (the bit with subscript 0). When you initialize a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> from a <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>, it is essential to remember this difference.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<p class="calibre25"><a id="filepos4613506"/>We need not use the entire <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> as the initial value for the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>. Instead, we can use a substring as the initializer:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">string str("1111111000000011001101");<br class="calibre6"/>bitset&lt;32&gt; bitvec5(str, 5, 4); // <span><span class="calibre45"><span class="calibre16">four bits starting at</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">str[5], 1100</span></span></tt></span><br class="calibre6"/>bitset&lt;32&gt; bitvec6(str, str.size()-4); // <span><span class="calibre45"><span class="calibre16">use last four characters</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre14">Here <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitvec5</span></tt></code> is initialized by the substring in <code class="calibre23"><tt class="calibre23"><span class="calibre24">str</span></tt></code> starting at <code class="calibre23"><tt class="calibre23"><span class="calibre24">str[5]</span></tt></code> and continuing for four positions. As usual, the right-most character of the substring represents the lowest-order bit. Thus, <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitvec5</span></tt></code> is initialized with bit positions 3 through 0 set to <code class="calibre23"><tt class="calibre23"><span class="calibre24">1100</span></tt></code> and the remaining bits set to <code class="calibre23"><tt class="calibre23"><span class="calibre24">0</span></tt></code>. The initializer for <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitvec6</span></tt></code> passes a <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> and a starting point, so <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitvec6</span></tt></code> is initialized from the characters in <code class="calibre23"><tt class="calibre23"><span class="calibre24">str</span></tt></code> starting four from the end of <code class="calibre23"><tt class="calibre23"><span class="calibre24">str</span></tt></code>. The remainder of the bits in <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitvec6</span></tt></code> are initialized to zero. We can view these initializations as</p><div class="calibre15">&#160;</div>
<div class="calibre52"><img alt="Image" src="images/00110.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 17.2.1</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 17.9:</strong> Explain the bit pattern each of the following <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> objects contains:</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre26"><p class="calibre53"><strong class="calibre5">(a)</strong>
<code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset&lt;64&gt; bitvec(32);</span></tt></code></p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre53"><strong class="calibre5">(b)</strong>
<code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset&lt;32&gt; bv(1010101);</span></tt></code></p></blockquote><div class="calibre15">&#160;</div>
<blockquote class="calibre26"><p class="calibre53"><strong class="calibre5">(c)</strong>
<code class="calibre23"><tt class="calibre23"><span class="calibre24">string bstr; cin &gt;&gt; bstr; bitset&lt;8&gt;bv(bstr);</span></tt></code></p></blockquote><div class="calibre15">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h4 id="filepos4617026" class="calibre37"><span class="calibre5">17.2.2. Operations on <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code>s</span></h4><div class="calibre38">&#160;</div>
<p class="calibre14">The <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> operations (<a href="164-17.2._the_bitset_type.html#filepos4618024">Table 17.3</a> (overleaf)) define various ways to test or set one or more bits. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> class also supports the bitwise operators that we covered in &#167; <a href="046-4.8._the_bitwise_operators.html#filepos1120642">4.8</a> (p. <a href="046-4.8._the_bitwise_operators.html#filepos1120642">152</a>). The operators have the same meaning when applied to <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> objects as the built-in operators have when applied to <code class="calibre23"><tt class="calibre23"><span class="calibre24">unsigned</span></tt></code> operands.</p><div class="calibre15">&#160;</div>
<p class="calibre51"><span class="calibre5"><a id="filepos4618016"/><a id="filepos4618024"/>Table 17.3. <code class="calibre23"><tt class="calibre23"><span class="calibre24"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code> Operations</span></p><div class="calibre12">&#160;</div>
<div class="calibre52"><img alt="Image" src="images/00111.jpg" class="calibre9"/></div><div class="calibre22">&#160;</div>
<p class="calibre14">Several operations&#8212;<code class="calibre23"><tt class="calibre23"><span class="calibre24">count, size, all, any</span></tt></code>, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">none</span></tt></code>&#8212;take no arguments and return information about the state of the entire <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>. Others&#8212;<code class="calibre23"><tt class="calibre23"><span class="calibre24">set, reset</span></tt></code>, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">flip</span></tt></code>&#8212;change the state of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>. The members that change the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> are overloaded. In each case, the version that takes no arguments applies the given operation to the entire set; the versions that take a position apply the operation to the given bit:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bitset&lt;32&gt; bitvec(1U); // <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">32</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">bits; low-order bit is</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1</span></span></tt></span><span><span class="calibre45"><span class="calibre16">, remaining bits are</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span><br class="calibre6"/>bool is_set = bitvec.any();&#160;&#160;&#160;&#160;&#160;&#160;// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">true,</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">one bit is set</span></span></span><br class="calibre6"/>bool is_not_set = bitvec.none(); // <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">false,</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">one bit is set</span></span></span><br class="calibre6"/>bool all_set = bitvec.all();&#160;&#160;&#160;&#160;&#160;// <span><tt class="calibre23"><span class="calibre46"><span class="calibre16">false,</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">only one bit is set</span></span></span><br class="calibre6"/>size_t onBits = bitvec.count();&#160;&#160;// <span><span class="calibre45"><span class="calibre16">returns</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1</span></span></tt></span><br class="calibre6"/>size_t sz = bitvec.size();&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">returns</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">32</span></span></tt></span><br class="calibre6"/>bitvec.flip();&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">reverses the value of all the bits in</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bitvec</span></span></tt></span><br class="calibre6"/>bitvec.reset();&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">sets all the bits to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span><br class="calibre6"/>bitvec.set();&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">sets all the bits to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">1</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<div class="calibre28"><a id="filepos4621644"/><img alt="Image" src="images/00008.jpg" class="calibre9"/></div>
<p class="calibre14">The <code class="calibre23"><tt class="calibre23"><span class="calibre24">any</span></tt></code> operation returns <code class="calibre23"><tt class="calibre23"><span class="calibre24">true</span></tt></code> if one or more bits of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> object are turned on&#8212;that is, are equal to 1. Conversely, <code class="calibre23"><tt class="calibre23"><span class="calibre24">none</span></tt></code> returns <code class="calibre23"><tt class="calibre23"><span class="calibre24">true</span></tt></code> if all the bits are zero. The new standard introduced the <code class="calibre23"><tt class="calibre23"><span class="calibre24">all</span></tt></code> operation, which returns <code class="calibre23"><tt class="calibre23"><span class="calibre24">true</span></tt></code> if all the bits are on. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">count</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">size</span></tt></code> operations return a <code class="calibre23"><tt class="calibre23"><span class="calibre24">size_t</span></tt></code> (&#167; <a href="034-3.5._arrays.html#filepos873638">3.5.2</a>, p. <a href="034-3.5._arrays.html#filepos873638">116</a>) equal to <a id="filepos4622758"/>the number of bits that are set, or the total number of bits in the object, respectively. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">size</span></tt></code> function is a <code class="calibre23"><tt class="calibre23"><span class="calibre24">constexpr</span></tt></code> and so can be used where a constant expression is required (&#167; <a href="024-2.4._const_qualifier.html#filepos520427">2.4.4</a>, p. <a href="024-2.4._const_qualifier.html#filepos520427">65</a>).</p><div class="calibre15">&#160;</div>
<p class="calibre25">The <code class="calibre23"><tt class="calibre23"><span class="calibre24">flip, set, reset</span></tt></code>, and <code class="calibre23"><tt class="calibre23"><span class="calibre24">test</span></tt></code> members let us read or write the bit at a given position:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bitvec.flip(0);&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">reverses the value of the first bit</span></span></span><br class="calibre6"/>bitvec.set(bitvec.size() - 1);&#160;&#160;// <span><span class="calibre45"><span class="calibre16">turns on the last bit</span></span></span><br class="calibre6"/>bitvec.set(0, 0); // <span><span class="calibre45"><span class="calibre16">turns off the first bit</span></span></span><br class="calibre6"/>bitvec.reset(i);&#160;&#160;// <span><span class="calibre45"><span class="calibre16">turns off the ith bit</span></span></span><br class="calibre6"/>bitvec.test(0);&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">returns</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">false</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">because the first bit is off</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<p class="calibre25">The subscript operator is overloaded on <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code>. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> version returns a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bool</span></tt></code> value <code class="calibre23"><tt class="calibre23"><span class="calibre24">true</span></tt></code> if the bit at the given index is on, <code class="calibre23"><tt class="calibre23"><span class="calibre24">false</span></tt></code> otherwise. The non<code class="calibre23"><tt class="calibre23"><span class="calibre24">const</span></tt></code> version returns a special type defined by <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> that lets us manipulate the bit value at the given index position:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bitvec[0] = 0;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">turn off the bit at position</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span><br class="calibre6"/>bitvec[31] = bitvec[0]; // <span><span class="calibre45"><span class="calibre16">set the last bit to the same value as the first bit</span></span></span><br class="calibre6"/>bitvec[0].flip();&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">flip the value of the bit at position</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span><br class="calibre6"/>~bitvec[0];&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">equivalent operation; flips the bit at position</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span><br class="calibre6"/>bool b = bitvec[0];&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">convert the value of</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bitvec[0]</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bool</span></span></tt></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<h5 class="calibre39"><span class="calibre5">Retrieving the Value of a <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code></span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">The <code class="calibre23"><tt class="calibre23"><span class="calibre24">to_ulong</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">to_ullong</span></tt></code> operations return a value that holds the same bit pattern as the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> object. We can use these operations only if the size of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> is less than or equal to the corresponding size, <code class="calibre23"><tt class="calibre23"><span class="calibre24">unsigned long</span></tt></code> for <code class="calibre23"><tt class="calibre23"><span class="calibre24">to_ulong</span></tt></code> and <code class="calibre23"><tt class="calibre23"><span class="calibre24">unsigned long long</span></tt></code> for <code class="calibre23"><tt class="calibre23"><span class="calibre24">to_ullong</span></tt></code>:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">unsigned long ulong = bitvec3.to_ulong();<br class="calibre6"/>cout &lt;&lt; "ulong = " &lt;&lt; ulong &lt;&lt; endl;</span></tt></p></blockquote><div class="calibre22">&#160;</div>
<div class="calibre33"><blockquote class="calibre26"><hr class="calibre34"/><p class="calibre14"><span class="calibre5"><a/><img alt="Image" src="images/00012.jpg" class="calibre9"/> Note</span></p><div class="calibre15">&#160;</div>
<blockquote class="calibre13"><p class="calibre14">These operations throw an <code class="calibre23"><tt class="calibre23"><span class="calibre24">overflow_error</span></tt></code> exception (&#167; <a href="059-5.6._try_blocks_and_exception_handling.html#filepos1368051">5.6</a>, p. <a href="059-5.6._try_blocks_and_exception_handling.html#filepos1368051">193</a>) if the value in the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> does not fit in the specified type.</p></blockquote><div class="calibre22">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<h5 class="calibre39"><span class="calibre5"><code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code> IO Operators</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">The input operator reads characters from the input stream into a temporary object of type <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code>. It reads until it has read as many characters as the size of the corresponding <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>, or it encounters a character other than 1 or 0, or it encounters end-of-file or an input error. The <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> is then initialized from that temporary <code class="calibre23"><tt class="calibre23"><span class="calibre24">string</span></tt></code> (&#167; <a href="164-17.2._the_bitset_type.html#filepos4604189">17.2.1</a>, p. <a href="164-17.2._the_bitset_type.html#filepos4604189">724</a>). If fewer characters are read than the size of the <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>, the high-order bits are, as usual, set to 0.</p><div class="calibre15">&#160;</div>
<p class="calibre25">The output operator prints the bit pattern in a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> object:</p><div class="calibre22">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bitset&lt;16&gt; bits;<br class="calibre6"/>cin &gt;&gt; bits;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">read up to 16 1 or 0 characters from</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">cin</span></span></tt></span><br class="calibre6"/>cout &lt;&lt; "bits: " &lt;&lt; bits &lt;&lt; endl; // <span><span class="calibre45"><span class="calibre16">print what we just read</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<h5 class="calibre39"><span class="calibre5"><a id="filepos4630955"/>Using <code class="calibre23"><tt class="calibre23"><span class="calibre49"><span><tt class="calibre23"><span class="calibre32"><span class="calibre5">bitset</span></span></tt></span></span></tt></code>s</span></h5><div class="calibre38">&#160;</div>
<p class="calibre14">To illustrate using <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code>s, we&#8217;ll reimplement the grading code from &#167; <a href="046-4.8._the_bitwise_operators.html#filepos1120642">4.8</a> (p. <a href="046-4.8._the_bitwise_operators.html#filepos1120642">154</a>) that used an <code class="calibre23"><tt class="calibre23"><span class="calibre24">unsigned long</span></tt></code> to represent the pass/fail quiz results for 30 students:</p><div class="calibre15">&#160;</div>
<p class="calibre40"><span class="calibre41"><span class="calibre5"/></span></p><div class="calibre38">&#160;</div>
<blockquote class="calibre13"><p class="calibre31"><tt class="calibre23"><span class="calibre24">bool status;<br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">version using bitwise operators</span></span></span><br class="calibre6"/>unsigned long quizA = 0;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">this value is used as a collection of bits</span></span></span><br class="calibre6"/>quizA |= 1UL &lt;&lt; 27;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">indicate student number 27 passed</span></span></span><br class="calibre6"/>status = quizA &amp; (1UL &lt;&lt; 27); // <span><span class="calibre45"><span class="calibre16">check how student number 27 did</span></span></span><br class="calibre6"/>quizA &amp;= ~(1UL &lt;&lt; 27);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">student number 27 failed</span></span></span><br class="calibre6"/>// <span><span class="calibre45"><span class="calibre16">equivalent actions using the</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">bitset</span></span></tt></span>
<span><span class="calibre45"><span class="calibre16">library</span></span></span><br class="calibre6"/>bitset&lt;30&gt; quizB;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">allocate one bit per student; all bits initialized to</span></span></span>
<span><tt class="calibre23"><span class="calibre46"><span class="calibre16">0</span></span></tt></span><br class="calibre6"/>quizB.set(27);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">indicate student number 27 passed</span></span></span><br class="calibre6"/>status = quizB[27];&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">check how student number 27 did</span></span></span><br class="calibre6"/>quizB.reset(27);&#160;&#160;&#160;&#160;&#160;&#160;// <span><span class="calibre45"><span class="calibre16">student number 27 failed</span></span></span></span></tt></p></blockquote><div class="calibre22">&#160;</div>
<div class="calibre42"><blockquote class="calibre26"><hr class="calibre34"/><blockquote class="calibre13"><p class="calibre43"><span class="calibre5">Exercises Section 17.2.2</span></p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 17.10:</strong> Using the sequence 1, 2, 3, 5, 8, 13, 21, initialize a <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> that has a <code class="calibre23"><tt class="calibre23"><span class="calibre24">1</span></tt></code> bit in each position corresponding to a number in this sequence. Default initialize another <code class="calibre23"><tt class="calibre23"><span class="calibre24">bitset</span></tt></code> and write a small program to turn on each of the appropriate bits.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 17.11:</strong> Define a data structure that contains an integral object to track responses to a true/false quiz containing 10 questions. What changes, if any, would you need to make in your data structure if the quiz had 100 questions?</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 17.12:</strong> Using the data structure from the previous question, write a function that takes a question number and a value to indicate a true/false answer and updates the quiz results accordingly.</p></blockquote><div class="calibre10">&#160;</div>
<blockquote class="calibre13"><p class="calibre44"><a/><strong class="calibre5">Exercise 17.13:</strong> Write an integral object that contains the correct answers for the true/false quiz. Use it to generate grades on the quiz for the data structure from the previous two exercises.</p></blockquote><div class="calibre10">&#160;</div>
<hr class="calibre34"/></blockquote></div><div class="calibre3">&#160;</div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="001-contents.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href="163-17.1._the_tuple_type.html"><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href="165-17.3._regular_expressions.html"><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></div></td></tr></table></body></html>
